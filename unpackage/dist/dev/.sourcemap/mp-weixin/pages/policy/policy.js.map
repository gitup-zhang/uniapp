{"version":3,"file":"policy.js","sources":["pages/policy/policy.vue","D:/Hbuild/HBuilderX.4.64.2025042916/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcG9saWN5L3BvbGljeS52dWU"],"sourcesContent":["<template>\r\n  <view class=\"page\">\r\n    <!-- 顶部固定导航栏 -->\r\n    <uni-nav-bar statusBar=\"true\" backgroundColor=\"#903749\" fixed=\"true\">\r\n      <template v-slot:left>\r\n        <view class=\"navbar-title\">新闻</view>\r\n      </template>\r\n    </uni-nav-bar>\r\n\r\n    <!-- 搜索栏 + 筛选栏固定区域 -->\r\n    <view class=\"fixed-top\">\r\n      <uni-search-bar \r\n        @confirm=\"search\" \r\n        placeholder=\"搜索行业新闻\" \r\n        v-model=\"searchbar\" \r\n        @cancel=\"cancel\">\r\n      </uni-search-bar>\r\n\r\n      <view class=\"filter-wrapper\">\n        <view class=\"filter-bar\">\n          <!-- 领域筛选 -->\n          <view class=\"filter-item\" @click=\"toggleDropdown('domain')\">\n            {{ selectedDomain?.field_name || '全部领域' }}\n            <view class=\"arrow\" :class=\"{ open: currentDropdown === 'domain' }\"></view>\n          </view>\n\n          <!-- 时间筛选 -->\n          <view class=\"filter-item\" @click=\"toggleDropdown('time')\">\n            {{ selectedTime }}\n            <view class=\"arrow\" :class=\"{ open: currentDropdown === 'time' }\"></view>\n          </view>\n        </view>\n\n        <!-- 领域下拉菜单 -->\n        <view v-if=\"currentDropdown === 'domain'\" class=\"dropdown-list\">\n          <!-- 全部选项 -->\n          <view \n            class=\"dropdown-item\" \n            @click=\"selectOption('domain', null)\" \n            :class=\"{ selected: selectedDomain === null }\"\n          >\n            全部\n          </view>\n          <!-- 具体领域项 -->\n          <view \n            class=\"dropdown-item\" \n            v-for=\"item in field.fieldlist\" \n            :key=\"item.field_id\"\n            @click=\"selectOption('domain', item)\" \n            :class=\"{ selected: selectedDomain?.field_id === item.field_id }\"\n          >\n            {{ item.field_name }}\n          </view>\n        </view>\n\n        <!-- 时间下拉菜单 -->\n        <view v-if=\"currentDropdown === 'time'\" class=\"dropdown-list\">\n          <view \n            class=\"dropdown-item\" \n            v-for=\"item in timeList\" \n            :key=\"item\"\n            @click=\"selectOption('time', item)\" \n            :class=\"{ selected: selectedTime === item }\"\n          >\n            {{ item }}\n          </view>\n        </view>\n      </view>\n    </view>\r\n\r\n    <!-- 新闻列表区域 -->\r\n    <scroll-view class=\"news-scroll\" scroll-y=\"true\">\r\n      <view>\r\n        <uni-card \r\n                        :title=\"item.policy_title\" \r\n                        :extra=\"Dataformat(item.release_time)\" \r\n                        v-for=\"item in listpolicy.listpolicy\" \r\n                        :key=\"item.id\"\r\n                  \t  @click=\"OnClick(item.id)\"\r\n                      >\r\n                        <text>{{item.brief_content}}</text>\r\n                      </uni-card>\r\n      </view>\r\n    </scroll-view>\r\n  </view>\r\n</template>\r\n\r\n\r\n<script setup>\r\nimport { ref, computed ,onMounted} from 'vue'\r\nimport {usePolicyStore} from '@/store/PolicyList.js'\r\nimport { Dataformat } from '../../utils/data'\r\nimport { usefieldstore } from '../../store/field.js'\r\n// 从pinia中获得对象\r\nconst listpolicy = usePolicyStore()\r\nconst field = usefieldstore()\r\n// 搜索栏\r\nconst searchbar = ref(\"\")\r\n\r\n// 当前打开的下拉框类型（'domain' | 'time'）\nconst currentDropdown = ref(null)\n\n// 当前选中的领域（对象或 null）和时间（字符串）\nconst selectedDomain = ref(null)\nconst selectedTime = ref('发布时间')\r\n\r\n// 时间列表\r\nconst timeList = ['全部', '最近一周', '最近一月', '最近一年']\r\n\r\n\r\nonMounted(()=>{\r\n\tlistpolicy.getlistpolicy()\r\n\tfield.getfield()\r\n})\r\n\r\n// 搜索栏函数\r\nfunction search() {\r\n listpolicy.searchpolicy({'policyTitle':searchbar.value})\r\n  console.log(\"搜索关键词:\", searchbar.value)\r\n}\r\n\r\nfunction cancel() {\r\n\tlistpolicy.getlistpolicy()\r\n  searchbar.value = \"\"\r\n}\r\n\r\n\r\n\r\n// 切换下拉框显示\nfunction toggleDropdown(type) {\n  currentDropdown.value = currentDropdown.value === type ? null : type\n}\n\n// 选择选项后处理\nfunction selectOption(type, value) {\n  if (type === 'domain') {\n    selectedDomain.value = value\n    if (value === null) {\n     listpolicy.getlistpolicy()\n    } else {\r\n\tlistpolicy.searchpolicy({'fieldID':value.field_id})\n      console.log(\"选中领域ID:\", value.field_id)\r\n\t  \n      \n    }\n  }\n\n  if (type === 'time') {\n    selectedTime.value = value\n  }\n\n  currentDropdown.value = null\n}\r\n// 获取详细政策\r\nfunction OnClick(id){\r\n\tuni.navigateTo({\r\n\t\turl: `/pages/detail/detailpolicy?id=${id}`\r\n\t});\r\n}\r\n\r\n</script>\r\n\r\n<style>\r\n@import url(\"../../style/new_policy.css\");\r\n.dropdown-list {\n  background-color: #fff;\n  border: 1px solid #ccc;\n  border-radius: 4rpx;\n  margin-top: 10rpx;\n}\n\n.dropdown-item {\n  padding: 20rpx;\n  font-size: 28rpx;\n  color: #333;\n}\n\n.dropdown-item.selected {\n  background-color: #f0f0f0;\n  font-weight: bold;\n}\n\n.filter-item {\n  /* padding: 20rpx;\n  font-size: 30rpx; */\r\n   padding: 12rpx 20rpx;\r\n   font-size: 30rpx;\r\n   display: flex;\r\n   align-items: center;\r\n   justify-content: space-between;\n}\n\n.arrow.open {\n  transform: rotate(180deg);\n}\r\n</style>\r\n","import MiniProgramPage from 'E:/project/uniapp/uniapp-news/pages/policy/policy.vue'\nwx.createPage(MiniProgramPage)"],"names":["usePolicyStore","usefieldstore","ref","onMounted","uni","MiniProgramPage"],"mappings":";;;;;;;;;;;;;;;;;;;;AA8FA,UAAM,aAAaA,iBAAAA,eAAgB;AACnC,UAAM,QAAQC,YAAAA,cAAe;AAE7B,UAAM,YAAYC,cAAG,IAAC,EAAE;AAGxB,UAAM,kBAAkBA,cAAG,IAAC,IAAI;AAGhC,UAAM,iBAAiBA,cAAG,IAAC,IAAI;AAC/B,UAAM,eAAeA,cAAG,IAAC,MAAM;AAG/B,UAAM,WAAW,CAAC,MAAM,QAAQ,QAAQ,MAAM;AAG9CC,kBAAAA,UAAU,MAAI;AACb,iBAAW,cAAe;AAC1B,YAAM,SAAU;AAAA,IACjB,CAAC;AAGD,aAAS,SAAS;AACjB,iBAAW,aAAa,EAAC,eAAc,UAAU,MAAK,CAAC;AACtDC,oBAAA,MAAA,MAAA,OAAA,kCAAY,UAAU,UAAU,KAAK;AAAA,IACvC;AAEA,aAAS,SAAS;AACjB,iBAAW,cAAe;AACzB,gBAAU,QAAQ;AAAA,IACpB;AAKA,aAAS,eAAe,MAAM;AAC5B,sBAAgB,QAAQ,gBAAgB,UAAU,OAAO,OAAO;AAAA,IAClE;AAGA,aAAS,aAAa,MAAM,OAAO;AACjC,UAAI,SAAS,UAAU;AACrB,uBAAe,QAAQ;AACvB,YAAI,UAAU,MAAM;AACnB,qBAAW,cAAe;AAAA,QAC/B,OAAW;AACV,qBAAW,aAAa,EAAC,WAAU,MAAM,SAAQ,CAAC;AAC7CA,wBAAY,MAAA,MAAA,OAAA,kCAAA,WAAW,MAAM,QAAQ;AAAA,QAGtC;AAAA,MACF;AAED,UAAI,SAAS,QAAQ;AACnB,qBAAa,QAAQ;AAAA,MACtB;AAED,sBAAgB,QAAQ;AAAA,IAC1B;AAEA,aAAS,QAAQ,IAAG;AACnBA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,iCAAiC,EAAE;AAAA,MAC1C,CAAE;AAAA,IACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7JA,GAAG,WAAWC,SAAe;"}