{"version":3,"file":"activitymore.js","sources":["pages/detail/activitymore.vue","D:/Hbuild/HBuilderX.4.64.2025042916/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZGV0YWlsL2FjdGl2aXR5bW9yZS52dWU"],"sourcesContent":["<template>\n\t<uni-nav-bar\n\t  statusBar=\"true\"\n\t  backgroundColor=\"#ff4757\"\n\t  fixed=\"true\"\n\t  :border=\"false\"\n\t  leftIcon=\"left\"\n\t  @clickLeft=\"onBack\"\n\t>\n\t  <!-- 居中标题插槽 -->\n\t  <template v-slot:default>\n\t    <view class=\"navbar-center\">\n\t      <text class=\"navbar-title\">热门活动</text>\n\t    </view>\n\t  </template>\n\t</uni-nav-bar>\n\t\n\t<scroll-view \n\t\tscroll-y=\"true\" \n\t\tstyle=\"height: calc(100vh - 44px);\" \n\t\t@scrolltolower=\"onReachBottom\"\n\t\tlower-threshold=\"50\"\n\t\trefresher-enabled=\"true\"\n\t\t:refresher-triggered=\"refreshing\"\n\t\t@refresherrefresh=\"onRefresh\"\n\t>\n\t\t<uni-grid :column=\"2\" :highlight=\"false\" :show-border=\"false\" @change=\"change\" :square=\"false\">\n\t\t\t<uni-grid-item v-for=\"item in EventStore.eventing\" :index=\"item.id\" :key=\"item.id\">\n\t\t\t\t<ActivityCard\n\t\t\t\t\t:imgSrc=\"item.cover_image_url\"\n\t\t\t\t\t:title=\"item.title\"\n\t\t\t\t\t:date=\"formatEventDate(item.event_start_time,item.event_end_time)\"\n\t\t\t\t\t:location=\"item.event_address\"\n\t\t\t\t\t:isJoined=\"false\"\n\t\t\t\t\t:fee=\"item.registration_fee\"\n\t\t\t\t/>\n\t\t\t</uni-grid-item>\n\t\t</uni-grid>\n\t\t\n\t\t<!-- 加载状态提示 -->\n\t\t<view class=\"load-more-container\">\n\t\t\t<view v-if=\"EventStore.isLoading && EventStore.eventing.length > 0\" class=\"loading-tip\">\n\t\t\t\t<uni-load-more status=\"loading\" />\n\t\t\t</view>\n\t\t\t<view v-else-if=\"!EventStore.hasMoreData && EventStore.eventing.length > 0\" class=\"loading-tip\">\n\t\t\t\t<uni-load-more status=\"noMore\" />\n\t\t\t</view>\n\t\t\t<view v-else-if=\"EventStore.eventing.length === 0 && !EventStore.isLoading\" class=\"empty-tip\">\n\t\t\t\t<text>暂无活动数据</text>\n\t\t\t</view>\n\t\t</view>\n\t</scroll-view>\n\t\n</template>\n\n<script setup>\nimport {ref,onMounted} from 'vue'\nimport { onLoad, onReachBottom as uniReachBottom } from '@dcloudio/uni-app'\nimport {useEventstore} from '@/store/Event.js'\t\nimport {formatEventDate} from '@/utils/data.js'\nimport ActivityCard from '@/components/ActivityCard/ActivityCard.vue'\n\n// 初始化pinia\nconst EventStore=useEventstore()\n\n// 下拉刷新状态\nconst refreshing = ref(false)\n\nfunction change(e){\n\tconst clickedIndex = e.detail.index\n\tconsole.log('点击了第', clickedIndex, '个宫格')\n\tconst disable = false\n\tuni.navigateTo({\n\t  url: `/pages/detail/activitydetail?id=${clickedIndex}&disable=${disable}`\n\t})\n}\n\n// 返回函数\nfunction onBack() {\n  uni.navigateBack();\n}\n\n// 触底加载更多\nconst onReachBottom = async () => {\n\tconsole.log('触底了，开始加载更多')\n\tif (EventStore.hasMoreData && !EventStore.isLoading) {\n\t\tawait EventStore.loadMoreEvents()\n\t}\n}\n\n// 下拉刷新\nconst onRefresh = async () => {\n\trefreshing.value = true\n\ttry {\n\t\tawait EventStore.refreshEvents()\n\t} finally {\n\t\trefreshing.value = false\n\t}\n}\n\nonLoad(()=>{\n\tEventStore.getlisting(10)\n})\n\n// 如果你的uni-app版本支持页面级的onReachBottom，可以保留这个\n// 但由于我们使用了scroll-view，主要依赖scroll-view的scrolltolower事件\n// uniReachBottom(onReachBottom)\n</script>\n\n<style>\n\t@import \"../../style/detail.css\";\n\t\n\t.load-more-container {\n\t\tpadding: 20rpx;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t}\n\t\n\t.loading-tip {\n\t\twidth: 100%;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tpadding: 20rpx 0;\n\t}\n\t\n\t.empty-tip {\n\t\twidth: 100%;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tpadding: 100rpx 0;\n\t\tcolor: #999;\n\t\tfont-size: 28rpx;\n\t}\n</style>","import MiniProgramPage from 'E:/project/uniapp/uniapp-news/pages/detail/activitymore.vue'\nwx.createPage(MiniProgramPage)"],"names":["useEventstore","ref","uni","onLoad","MiniProgramPage"],"mappings":";;;;;;;;;;;;;;;;;;AA4DA,MAAM,eAAe,MAAW;;;;AAGhC,UAAM,aAAWA,YAAAA,cAAe;AAGhC,UAAM,aAAaC,cAAG,IAAC,KAAK;AAE5B,aAAS,OAAO,GAAE;AACjB,YAAM,eAAe,EAAE,OAAO;AAC9BC,oBAAY,MAAA,MAAA,OAAA,uCAAA,QAAQ,cAAc,KAAK;AACvC,YAAM,UAAU;AAChBA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,mCAAmC,YAAY,YAAY,OAAO;AAAA,MAC1E,CAAE;AAAA,IACF;AAGA,aAAS,SAAS;AAChBA,oBAAG,MAAC,aAAY;AAAA,IAClB;AAGA,UAAM,gBAAgB,YAAY;AACjCA,oBAAAA,MAAY,MAAA,OAAA,uCAAA,YAAY;AACxB,UAAI,WAAW,eAAe,CAAC,WAAW,WAAW;AACpD,cAAM,WAAW,eAAgB;AAAA,MACjC;AAAA,IACF;AAGA,UAAM,YAAY,YAAY;AAC7B,iBAAW,QAAQ;AACnB,UAAI;AACH,cAAM,WAAW,cAAe;AAAA,MAClC,UAAW;AACT,mBAAW,QAAQ;AAAA,MACnB;AAAA,IACF;AAEAC,kBAAAA,OAAO,MAAI;AACV,iBAAW,WAAW,EAAE;AAAA,IACzB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrGD,GAAG,WAAWC,SAAe;"}