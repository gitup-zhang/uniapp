{"version":3,"file":"activityjoined.js","sources":["pages/detail/activityjoined.vue","D:/Hbuild/HBuilderX.4.64.2025042916/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZGV0YWlsL2FjdGl2aXR5am9pbmVkLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"page-container\">\n    <!-- 自定义导航栏 -->\n    <view class=\"custom-navbar\">\n      <!-- 状态栏占位 -->\n      <view class=\"status-bar\" :style=\"{ height: statusBarHeight + 'px' }\"></view>\n      <!-- 导航栏内容 -->\n      <view class=\"navbar-content\">\n        <view class=\"navbar-left\" @click=\"onBack\">\n          <text class=\"back-icon\">←</text>\n        </view>\n        <view class=\"navbar-center\">\n          <text class=\"navbar-title\">参加的活动</text>\n        </view>\n        <view class=\"navbar-right\">\n          <!-- 右侧可以放置其他操作按钮 -->\n        </view>\n      </view>\n    </view>\n    \n    <!-- Tab栏 -->\n    <view class=\"tab-bar\">\n      <view class=\"tab-bar-placeholder\" :style=\"{ height: (statusBarHeight + 44) + 'px' }\"></view>\n      <view class=\"tab-container\">\n        <view \n          class=\"tab-item\" \n          :class=\"{ active: activeTab === 'active' }\"\n          @click=\"switchTab('active')\"\n        >\n          <text class=\"tab-text\">未过期</text>\n          <view class=\"tab-indicator\" v-if=\"activeTab === 'active'\"></view>\n        </view>\n        <view \n          class=\"tab-item\" \n          :class=\"{ active: activeTab === 'expired' }\"\n          @click=\"switchTab('expired')\"\n        >\n          <text class=\"tab-text\">已过期</text>\n          <view class=\"tab-indicator\" v-if=\"activeTab === 'expired'\"></view>\n        </view>\n      </view>\n    </view>\n    \n    <!-- 内容区域 -->\n    <view class=\"content-container\">\n      <!-- 占位区域，避免被导航栏和tab栏遮挡 -->\n      <view class=\"content-placeholder\" :style=\"{ height: (statusBarHeight + 44 + 50) + 'px' }\"></view>\n      \n      <!-- 活动列表 - 统一使用scroll-view -->\n      <scroll-view \n        class=\"activity-list\" \n        scroll-y=\"true\" \n        :show-scrollbar=\"false\"\n        :enable-back-to-top=\"false\"\n      >\n        <view class=\"list-content\">\n          <view v-if=\"currentActivityList.length === 0\" class=\"empty-state\">\n            <view class=\"empty-icon\">📅</view>\n            <text class=\"empty-text\">{{ activeTab === 'active' ? '暂无未过期的活动' : '暂无已过期的活动' }}</text>\n          </view>\n          \n          <view v-else class=\"activity-items\">\n            <ActivityTicketList\n              v-for=\"activity in currentActivityList\"\n              :key=\"activity.id\"\r\n\t\t\t  :status=\"activeTab\" \n              :activityData=\"activity\"\n              @action=\"handleAction\"\n              @cancel=\"handleCancel\"\n            />\n          </view>\n        </view>\n      </scroll-view>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted, nextTick, computed } from 'vue'\nimport ActivityTicketList from '@/components/ActivityTicket/ActivityTicketList.vue'// 根据你的实际路径调整\nimport { useInfoStore } from '@/store/Info.js'\nimport {cancelapply} from '@/new-apis/events.js'\n\nconst useinfo = useInfoStore()\n\n// 获取系统状态栏高度\nconst statusBarHeight = ref(0)\n\n// Tab相关状态\nconst activeTab = ref('active') // 'active' | 'expired'\n\n// 活动列表数据\nconst activityList = ref([])\nconst expiredActivityList = ref([])\n\n// 根据当前tab返回对应的活动列表\nconst currentActivityList = computed(() => {\n  return activeTab.value === 'active' ? activityList.value : expiredActivityList.value\n})\n\n// 切换Tab\nconst switchTab = (tab) => {\n  if (activeTab.value !== tab) {\n    activeTab.value = tab\n  }\n}\n\n// 页面加载时获取数据\nonMounted(() => {\n  // 获取系统信息\n  const systemInfo = uni.getSystemInfoSync()\n  statusBarHeight.value = systemInfo.statusBarHeight || 20\n   // 加载活动数据\n  loadActivityData()\n})\n\n// 加载活动数据\nconst loadActivityData = async () => {\n  try {\n     await useinfo.userapply()\n    activityList.value = useinfo.applyactivity\n    expiredActivityList.value = useinfo.applyactivityhistory\n  } catch (error) {\n    console.error('加载活动数据失败:', error)\n    uni.showToast({\n      title: '加载失败',\n      icon: 'error'\n    })\n  }\n}\n\n// 处理主要操作（如签到）\nconst handleAction = (activityData) => {\n  console.log('操作活动:', activityData)\n  \n  // 对已过期的活动不允许操作\n  if (activeTab.value === 'expired') {\n    uni.showToast({\n      title: '活动已过期，无法操作',\n      icon: 'none'\n    })\n    return\n  }\n  \n  uni.showToast({\n    title: `执行: ${activityData.statusText}`,\n    icon: 'success'\n  })\n  \n  // 这里添加你的具体业务逻辑\n  // 比如跳转到签到页面、执行签到操作等\n}\n\n// 处理取消报名\nconst handleCancel = (activityData) => {\n  console.log('取消报名:', activityData)\n  \n  // 对已过期的活动不允许取消报名\n  if (activeTab.value === 'expired') {\n    uni.showToast({\n      title: '活动已过期，无法取消报名',\n      icon: 'none'\n    })\n    return\n  }\n  \n  uni.showModal({\n    title: '确认取消',\n    content: `确定要取消报名\"${activityData.title}\"吗？`,\n    success: (res) => {\n      if (res.confirm) {\n        // 执行取消报名的逻辑\n        cancelSignUp(activityData)\n      }\n    }\n  })\n}\n\n// 取消报名的具体实现\nconst cancelSignUp = async (activityData) => {\n  try {\n    await cancelapply(activityData.id)\n    loadActivityData()\n    \n    uni.showToast({\n      title: '取消报名成功',\n      icon: 'success'\n    })\n  } catch (error) {\n    console.error('取消报名失败:', error)\n    uni.showToast({\n      title: '取消失败',\n      icon: 'error'\n    })\n  }\n}\n\n// 返回函数\nfunction onBack() {\n  uni.navigateBack()\n}\n</script>\n\n<style scoped>\n@import \"../../style/detail.css\";\n\n.page-container {\n  height: 100vh;\n  background: #f5f5f5;\n}\n\n.content-container {\n  height: 100vh;\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n}\n\n/* 自定义导航栏样式 */\n.custom-navbar {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  z-index: 1000;\n  background: linear-gradient(135deg, #ff4757, #ff3742);\n  box-shadow: 0 2rpx 10rpx rgba(255, 71, 87, 0.3);\n}\n\n.status-bar {\n  width: 100%;\n  background: transparent;\n}\n\n.navbar-content {\n  height: 88rpx;\n  display: flex;\n  align-items: center;\n  padding: 0 32rpx;\n  position: relative;\n}\n\n.navbar-left {\n  width: 88rpx;\n  height: 88rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 50%;\n  transition: background-color 0.2s ease;\n}\n\n.navbar-left:active {\n  background-color: rgba(255, 255, 255, 0.1);\n}\n\n.back-icon {\n  font-size: 40rpx;\n  color: white;\n  font-weight: bold;\n  line-height: 1;\n}\n\n.navbar-center {\n  position: absolute;\n  left: 50%;\n  transform: translateX(-50%);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.navbar-title {\n  font-size: 36rpx;\n  font-weight: bold;\n  color: white;\n  text-shadow: 0 2rpx 4rpx rgba(0, 0, 0, 0.1);\n}\n\n.navbar-right {\n  width: 88rpx;\n  height: 88rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n/* Tab栏样式 */\n.tab-bar {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  z-index: 999;\n  background: white;\n  box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.1);\n}\n\n.tab-bar-placeholder {\n  width: 100%;\n  background: transparent;\n}\n\n.tab-container {\n  display: flex;\n  height: 100rpx;\n  background: white;\n  border-bottom: 1rpx solid #f0f0f0;\n}\n\n.tab-item {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n  transition: all 0.3s ease;\n}\n\n.tab-item:active {\n  background-color: rgba(255, 71, 87, 0.05);\n}\n\n.tab-text {\n  font-size: 30rpx;\n  color: #666;\n  font-weight: 500;\n  transition: color 0.3s ease;\n}\n\n.tab-item.active .tab-text {\n  color: #ff4757;\n  font-weight: 600;\n}\n\n.tab-indicator {\n  position: absolute;\n  bottom: 0;\n  left: 50%;\n  transform: translateX(-50%);\n  width: 60rpx;\n  height: 6rpx;\n  background: linear-gradient(135deg, #ff4757, #ff3742);\n  border-radius: 3rpx;\n  animation: slideIn 0.3s ease;\n}\n\n@keyframes slideIn {\n  from {\n    width: 0;\n    opacity: 0;\n  }\n  to {\n    width: 60rpx;\n    opacity: 1;\n  }\n}\n\n/* 简化后的列表样式 */\n.activity-list {\n  flex: 1;\n  width: 100%;\n}\n\n.list-content {\n  padding-bottom: 20rpx;\n  box-sizing: border-box;\n  min-height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n\n.activity-items {\n  flex: 1;\n}\n\n.content-placeholder {\n  flex-shrink: 0;\n}\n\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  flex: 1;\n  min-height: 60vh;\n  padding: 40rpx;\n}\n\n/* 空状态样式 */\n.empty-icon {\n  font-size: 100rpx;\n  margin-bottom: 20rpx;\n  opacity: 0.5;\n}\n\n.empty-text {\n  font-size: 28rpx;\n  color: #999;\n  text-align: center;\n}\n</style>","import MiniProgramPage from 'E:/project/uniapp/uniapp-news/pages/detail/activityjoined.vue'\nwx.createPage(MiniProgramPage)"],"names":["useInfoStore","ref","computed","onMounted","uni","cancelapply"],"mappings":";;;;;;;AA+EA,MAAM,qBAAqB,MAAW;;;;AAItC,UAAM,UAAUA,WAAAA,aAAc;AAG9B,UAAM,kBAAkBC,cAAG,IAAC,CAAC;AAG7B,UAAM,YAAYA,cAAG,IAAC,QAAQ;AAG9B,UAAM,eAAeA,cAAG,IAAC,EAAE;AAC3B,UAAM,sBAAsBA,cAAG,IAAC,EAAE;AAGlC,UAAM,sBAAsBC,cAAQ,SAAC,MAAM;AACzC,aAAO,UAAU,UAAU,WAAW,aAAa,QAAQ,oBAAoB;AAAA,IACjF,CAAC;AAGD,UAAM,YAAY,CAAC,QAAQ;AACzB,UAAI,UAAU,UAAU,KAAK;AAC3B,kBAAU,QAAQ;AAAA,MACnB;AAAA,IACH;AAGAC,kBAAAA,UAAU,MAAM;AAEd,YAAM,aAAaC,cAAG,MAAC,kBAAmB;AAC1C,sBAAgB,QAAQ,WAAW,mBAAmB;AAEtD,uBAAkB;AAAA,IACpB,CAAC;AAGD,UAAM,mBAAmB,YAAY;AACnC,UAAI;AACD,cAAM,QAAQ,UAAW;AAC1B,qBAAa,QAAQ,QAAQ;AAC7B,4BAAoB,QAAQ,QAAQ;AAAA,MACrC,SAAQ,OAAO;AACdA,sBAAAA,MAAA,MAAA,SAAA,0CAAc,aAAa,KAAK;AAChCA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACF;AAAA,IACH;AAGA,UAAM,eAAe,CAAC,iBAAiB;AACrCA,oBAAAA,6DAAY,SAAS,YAAY;AAGjC,UAAI,UAAU,UAAU,WAAW;AACjCA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AACD;AAAA,MACD;AAEDA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO,OAAO,aAAa,UAAU;AAAA,QACrC,MAAM;AAAA,MACV,CAAG;AAAA,IAIH;AAGA,UAAM,eAAe,CAAC,iBAAiB;AACrCA,oBAAAA,6DAAY,SAAS,YAAY;AAGjC,UAAI,UAAU,UAAU,WAAW;AACjCA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AACD;AAAA,MACD;AAEDA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS,WAAW,aAAa,KAAK;AAAA,QACtC,SAAS,CAAC,QAAQ;AAChB,cAAI,IAAI,SAAS;AAEf,yBAAa,YAAY;AAAA,UAC1B;AAAA,QACF;AAAA,MACL,CAAG;AAAA,IACH;AAGA,UAAM,eAAe,OAAO,iBAAiB;AAC3C,UAAI;AACF,cAAMC,eAAW,YAAC,aAAa,EAAE;AACjC,yBAAkB;AAElBD,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACF,SAAQ,OAAO;AACdA,sBAAAA,MAAA,MAAA,SAAA,0CAAc,WAAW,KAAK;AAC9BA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACF;AAAA,IACH;AAGA,aAAS,SAAS;AAChBA,oBAAAA,MAAI,aAAc;AAAA,IACpB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvMA,GAAG,WAAW,eAAe;"}