{"version":3,"file":"GroupMesDetail.js","sources":["pages/detail/GroupMesDetail.vue","D:/Hbuild/HBuilderX.4.64.2025042916/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZGV0YWlsL0dyb3VwTWVzRGV0YWlsLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"message-detail-page\">\n    <!-- 自定义导航栏 -->\n    <view class=\"custom-navbar\">\n      <view class=\"status-bar\" :style=\"{ height: statusBarHeight + 'px' }\"></view>\n      <view class=\"nav-content\">\n        <view class=\"nav-left\" @tap=\"goBack\">\n          <view class=\"back-btn\">\n            <text class=\"back-icon\">‹</text>\n          </view>\n        </view>\n        <view class=\"nav-center\">\n          <text class=\"nav-title\">消息详情</text>\n          <text class=\"nav-subtitle\">管理员通知</text>\n        </view>\n        <view class=\"nav-right\"></view>\n      </view>\n    </view>\n\n    <!-- 消息详情内容 -->\n    <scroll-view \n      class=\"detail-scroll\"\n      :style=\"{ marginTop: statusBarHeight + 48 + 'px' }\"\n      scroll-y=\"true\"\n    >\n      <view class=\"detail-content\">\n        <!-- 管理员信息头部 -->\n        <view class=\"admin-header\">\n          <view class=\"admin-avatar\" :class=\"{ important: message.priority === 'high' }\">\n            <text class=\"avatar-text\">管</text>\n          </view>\n          <view class=\"admin-info\">\n            <view class=\"name-row\">\n              <text class=\"admin-name\">{{ message.sender_name || '系统管理员' }}</text>\n              <view class=\"admin-badge\">\n                <text class=\"badge-text\">管理员</text>\n              </view>\n            </view>\n            <text class=\"send-time\">{{ formatDetailTime(message.created_at) }}</text>\n          </view>\n          <view v-if=\"message.priority === 'high'\" class=\"priority-indicator\">\n            <text class=\"priority-text\">重要</text>\n          </view>\n        </view>\n\n        <!-- 消息主体卡片 -->\n        <view class=\"message-card\">\n          <!-- 消息标题 -->\n          <view v-if=\"message.title\" class=\"message-title-section\">\n            <text class=\"message-title\">{{ message.title }}</text>\n          </view>\n\n          <!-- 消息类型标签 -->\n          <view v-if=\"message.type && message.type !== 'normal'\" class=\"message-type-section\">\n            <view class=\"type-tag\" :class=\"`tag-${message.type}`\">\n              <text class=\"type-text\">{{ getTypeLabel(message.type) }}</text>\n            </view>\n          </view>\n\n          <!-- 消息内容 -->\n          <view class=\"message-body\">\n            <!-- 文本内容 -->\n            <view v-if=\"textContent\" class=\"text-section\">\n              <text class=\"content-text\">{{ textContent }}</text>\n            </view>\n\n            <!-- 媒体内容 -->\n            <view v-if=\"mediaItems.length > 0\" class=\"media-section\">\n              <view \n                v-for=\"(media, index) in mediaItems\" \n                :key=\"index\"\n                class=\"media-item\"\n              >\n                <!-- 图片 -->\n                <view v-if=\"media.type === 'image'\" class=\"image-container\">\n                  <image \n                    :src=\"media.url\"\n                    class=\"media-image\"\n                    mode=\"widthFix\"\n                    @tap=\"previewImage(media.url, getAllImageUrls())\"\n                    @load=\"onImageLoad\"\n                    @error=\"onImageError\"\n                  />\n                </view>\n                \n                <!-- 视频 -->\n                <view v-if=\"media.type === 'video'\" class=\"video-container\">\n                  <video \n                    :src=\"media.url\"\n                    :poster=\"media.poster\"\n                    class=\"media-video\"\n                    controls\n                    :show-center-play-btn=\"true\"\n                    :show-play-btn=\"true\"\n                    object-fit=\"contain\"\n                  />\n                </view>\n              </view>\n            </view>\n          </view>\n        </view>\n\n        <!-- 底部间距 -->\n        <view class=\"bottom-spacing\"></view>\n      </view>\n    </scroll-view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue'\nimport { onLoad } from '@dcloudio/uni-app'\n\n// 页面状态\nconst statusBarHeight = ref(0)\n\n// 消息数据\nconst message = ref({\n  id: '1',\n  sender_name: '系统管理员',\n  title: '重要系统维护通知',\n  content: `尊敬的用户：\n\n为了提升系统性能和用户体验，我们将于本周末进行重要的系统维护升级。具体安排如下：\n\n🕐 维护时间：2025年8月21日 02:00 - 06:00\n🔧 影响范围：全平台服务暂停\n⏰ 预计恢复：当日上午6点前完全恢复\n\n维护期间，您可能遇到以下情况：\n• 无法正常登录和使用平台服务\n• 数据同步可能出现延迟  \n• 部分功能临时不可用\n\n[img:https://fuss10.elemecdn.com/3/28/bbf893f792f03a54408b3b7a7ebf0jpeg.jpeg]\n\n本次升级将带来以下改进：\n✨ 全新的用户界面设计\n🚀 更快的响应速度（提升40%）\n🔒 增强的安全防护机制\n📱 优化移动端体验\n\n[video:https://media.w3.org/2010/05/sintel/trailer.mp4]\n\n为了确保您的数据安全，建议您：\n1. 提前保存重要工作内容\n2. 避免在维护期间进行重要操作\n3. 关注我们的官方公告获取最新进展\n\n感谢您的理解与支持！如有紧急问题，请联系客服热线：400-123-4567\n\n祝您使用愉快！`,\n  type: 'maintenance',\n  priority: 'high',\n  created_at: '2025-08-19T14:30:00.000Z'\n})\n\n// 解析消息内容\nconst { textContent, mediaItems } = parseMessageContent(message.value.content || '')\n\n// 生命周期\nonMounted(() => {\n  const sysInfo = uni.getSystemInfoSync()\n  statusBarHeight.value = sysInfo.statusBarHeight || 0\n})\n\nonLoad((options) => {\n  // 这里可以根据传入的参数加载具体消息\n  if (options.id) {\n    // loadMessageDetail(options.id)\n  }\n})\n\n// 解析消息内容，分离文本和媒体\nfunction parseMessageContent(content) {\n  if (!content) return { textContent: '', mediaItems: [] }\n  \n  const mediaItems = []\n  let textContent = content\n  \n  // 匹配图片\n  const imageRegex = /\\[(?:img|image):([^\\]]+)\\]/g\n  textContent = textContent.replace(imageRegex, (match, url) => {\n    mediaItems.push({\n      type: 'image',\n      url: url.trim()\n    })\n    return ''\n  })\n  \n  // 匹配视频\n  const videoRegex = /\\[(?:video|vid):([^\\]]+)(?:\\|poster:([^\\]]+))?\\]/g\n  textContent = textContent.replace(videoRegex, (match, url, poster) => {\n    mediaItems.push({\n      type: 'video',\n      url: url.trim(),\n      poster: poster ? poster.trim() : ''\n    })\n    return ''\n  })\n  \n  // 清理多余的空行\n  textContent = textContent.replace(/\\n\\s*\\n\\s*\\n/g, '\\n\\n').trim()\n  \n  return { textContent, mediaItems }\n}\n\n// 格式化详细时间\nconst formatDetailTime = (timeStr) => {\n  if (!timeStr) return ''\n  \n  const time = new Date(timeStr)\n  const year = time.getFullYear()\n  const month = String(time.getMonth() + 1).padStart(2, '0')\n  const day = String(time.getDate()).padStart(2, '0')\n  const hours = String(time.getHours()).padStart(2, '0')\n  const minutes = String(time.getMinutes()).padStart(2, '0')\n  \n  return `${year}年${month}月${day}日 ${hours}:${minutes}`\n}\n\n// 获取类型标签\nconst getTypeLabel = (type) => {\n  const labels = {\n    'announcement': '公告',\n    'maintenance': '维护',\n    'event': '活动',\n    'security': '安全',\n    'update': '更新',\n    'normal': '通知'\n  }\n  return labels[type] || '通知'\n}\n\n// 获取所有图片URL\nconst getAllImageUrls = () => {\n  return mediaItems.filter(item => item.type === 'image').map(item => item.url)\n}\n\n// 预览图片\nconst previewImage = (current, urls) => {\n  uni.previewImage({\n    current,\n    urls\n  })\n}\n\n// 图片加载成功\nconst onImageLoad = (e) => {\n  console.log('图片加载成功', e)\n}\n\n// 图片加载失败\nconst onImageError = (e) => {\n  console.log('图片加载失败', e)\n  uni.showToast({\n    title: '图片加载失败',\n    icon: 'none',\n    duration: 2000\n  })\n}\n\n// 返回上一页\nconst goBack = () => {\n  uni.navigateBack()\n}\n</script>\n\n<style scoped>\n.message-detail-page {\n  min-height: 100vh;\n  background: #f8fafc;\n  display: flex;\n  flex-direction: column;\n}\n\n/* 导航栏样式 - 与父组件保持一致 */\n.custom-navbar {\n  background: linear-gradient(135deg, #ef4444 0%, #dc2626 50%, #b91c1c 100%);\n  color: white;\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  z-index: 1000;\n  box-shadow: 0 2rpx 16rpx rgba(102, 126, 234, 0.3);\n}\n\n.status-bar {\n  width: 100%;\n}\n\n.nav-content {\n  height: 88rpx;\n  display: flex;\n  align-items: center;\n  padding: 0 32rpx;\n  position: relative;\n}\n\n.nav-left {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 60rpx;\n  height: 60rpx;\n  border-radius: 50%;\n}\n\n.back-btn {\n  width: 64rpx;\n  height: 64rpx;\n  border-radius: 50%;\n  background: rgba(255, 255, 255, 0.2);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.3s ease;\n  backdrop-filter: blur(10rpx);\n}\n\n.back-btn:active {\n  background: rgba(255, 255, 255, 0.3);\n  transform: scale(0.95);\n}\n\n.back-icon {\n  font-size: 44rpx;\n  color: white;\n  font-weight: 300;\n  margin-left: -4rpx;\n}\n\n.nav-center {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 0 32rpx;\n}\n\n.nav-title {\n  font-size: 32rpx;\n  font-weight: 600;\n  color: white;\n  line-height: 1.2;\n}\n\n.nav-subtitle {\n  font-size: 22rpx;\n  color: rgba(255, 255, 255, 0.8);\n  margin-top: 4rpx;\n}\n\n.nav-right {\n  width: 60rpx;\n}\n\n/* 详情内容 */\n.detail-scroll {\n  flex: 1;\n  background: #f8fafc;\n}\n\n.detail-content {\n  padding: 32rpx 24rpx;\n}\n\n/* 管理员信息头部 */\n.admin-header {\n  background: white;\n  border-radius: 20rpx;\n  padding: 32rpx;\n  margin-bottom: 24rpx;\n  box-shadow: 0 2rpx 12rpx rgba(0, 0, 0, 0.08);\n  display: flex;\n  align-items: center;\n  gap: 24rpx;\n  position: relative;\n}\n\n.admin-avatar {\n  width: 88rpx;\n  height: 88rpx;\n  border-radius: 22rpx;\n  background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-shadow: 0 4rpx 16rpx rgba(245, 158, 11, 0.3);\n  flex-shrink: 0;\n}\n\n.admin-avatar.important {\n  animation: pulse 2s infinite;\n}\n\n.avatar-text {\n  font-size: 30rpx;\n  font-weight: 700;\n  color: white;\n}\n\n.admin-info {\n  flex: 1;\n}\n\n.name-row {\n  display: flex;\n  align-items: center;\n  gap: 16rpx;\n  margin-bottom: 8rpx;\n}\n\n.admin-name {\n  font-size: 30rpx;\n  font-weight: 600;\n  color: #1e293b;\n}\n\n.admin-badge {\n  background: #f59e0b;\n  color: white;\n  font-size: 20rpx;\n  padding: 6rpx 16rpx;\n  border-radius: 20rpx;\n  box-shadow: 0 2rpx 8rpx rgba(245, 158, 11, 0.2);\n}\n\n.badge-text {\n  font-size: 20rpx;\n  font-weight: 600;\n  color: white;\n}\n\n.send-time {\n  font-size: 24rpx;\n  color: #64748b;\n}\n\n.priority-indicator {\n  position: absolute;\n  top: 20rpx;\n  right: 20rpx;\n  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\n  color: white;\n  padding: 8rpx 16rpx;\n  border-radius: 16rpx;\n  box-shadow: 0 2rpx 8rpx rgba(239, 68, 68, 0.3);\n}\n\n.priority-text {\n  font-size: 20rpx;\n  font-weight: 600;\n  color: white;\n}\n\n/* 消息卡片 */\n.message-card {\n  background: white;\n  border-radius: 20rpx;\n  padding: 32rpx;\n  box-shadow: 0 2rpx 12rpx rgba(0, 0, 0, 0.08);\n}\n\n/* 消息标题 */\n.message-title-section {\n  margin-bottom: 24rpx;\n  padding-bottom: 24rpx;\n  border-bottom: 2rpx solid #f1f5f9;\n}\n\n.message-title {\n  font-size: 34rpx;\n  font-weight: 600;\n  color: #1e293b;\n  line-height: 1.4;\n}\n\n/* 消息类型 */\n.message-type-section {\n  margin-bottom: 24rpx;\n}\n\n.type-tag {\n  display: inline-block;\n  padding: 12rpx 24rpx;\n  border-radius: 24rpx;\n  font-size: 24rpx;\n  font-weight: 500;\n}\n\n.tag-announcement {\n  background: rgba(239, 68, 68, 0.1);\n  color: #dc2626;\n  border: 2rpx solid rgba(239, 68, 68, 0.2);\n}\n\n.tag-maintenance {\n  background: rgba(245, 158, 11, 0.1);\n  color: #d97706;\n  border: 2rpx solid rgba(245, 158, 11, 0.2);\n}\n\n.tag-event {\n  background: rgba(16, 185, 129, 0.1);\n  color: #059669;\n  border: 2rpx solid rgba(16, 185, 129, 0.2);\n}\n\n.tag-security {\n  background: rgba(139, 69, 19, 0.1);\n  color: #a16207;\n  border: 2rpx solid rgba(139, 69, 19, 0.2);\n}\n\n.tag-update {\n  background: rgba(102, 126, 234, 0.1);\n  color: #4f46e5;\n  border: 2rpx solid rgba(102, 126, 234, 0.2);\n}\n\n.type-text {\n  font-size: 24rpx;\n  font-weight: 600;\n}\n\n/* 消息主体 */\n.message-body {\n  line-height: 1.6;\n}\n\n/* 文本内容 */\n.text-section {\n  margin-bottom: 24rpx;\n}\n\n.content-text {\n  font-size: 30rpx;\n  line-height: 1.7;\n  color: #334155;\n  word-break: break-word;\n  white-space: pre-wrap;\n}\n\n/* 媒体内容 */\n.media-section {\n  margin-top: 24rpx;\n}\n\n.media-item {\n  margin-bottom: 24rpx;\n}\n\n.media-item:last-child {\n  margin-bottom: 0;\n}\n\n/* 图片容器 */\n.image-container {\n  border-radius: 16rpx;\n  overflow: hidden;\n  background: #f8fafc;\n  box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.1);\n  transition: transform 0.2s ease;\n}\n\n.image-container:active {\n  transform: scale(0.98);\n}\n\n.media-image {\n  width: 100%;\n  display: block;\n  border-radius: 16rpx;\n}\n\n/* 视频容器 */\n.video-container {\n  border-radius: 16rpx;\n  overflow: hidden;\n  box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.1);\n}\n\n.media-video {\n  width: 100%;\n  height: 400rpx;\n  border-radius: 16rpx;\n  background: #000;\n}\n\n/* 底部间距 */\n.bottom-spacing {\n  height: 60rpx;\n}\n\n/* 头像闪烁动画 */\n@keyframes pulse {\n  0%, 100% {\n    box-shadow: 0 4rpx 16rpx rgba(245, 158, 11, 0.3);\n  }\n  50% {\n    box-shadow: 0 4rpx 24rpx rgba(245, 158, 11, 0.6);\n  }\n}\n\n/* 响应式设计 */\n@media (max-width: 750rpx) {\n  .detail-content {\n    padding: 24rpx 16rpx;\n  }\n  \n  .admin-header {\n    padding: 24rpx;\n  }\n  \n  .message-card {\n    padding: 24rpx;\n  }\n  \n  .media-video {\n    height: 320rpx;\n  }\n}\n\n/* 暗黑模式适配 */\n@media (prefers-color-scheme: dark) {\n  .message-detail-page {\n    background: #0f172a;\n  }\n  \n  .detail-scroll {\n    background: #0f172a;\n  }\n  \n  .admin-header, .message-card {\n    background: #1e293b;\n    border-color: #334155;\n  }\n  \n  .admin-name {\n    color: #f1f5f9;\n  }\n  \n  .message-title {\n    color: #f1f5f9;\n  }\n  \n  .content-text {\n    color: #cbd5e1;\n  }\n  \n  .send-time {\n    color: #94a3b8;\n  }\n  \n  .message-title-section {\n    border-bottom-color: #334155;\n  }\n}\n</style>","import MiniProgramPage from 'E:/project/uniapp/uniapp-news/pages/detail/GroupMesDetail.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onMounted","uni","onLoad","mediaItems","textContent"],"mappings":"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"}