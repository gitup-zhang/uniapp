{"version":3,"file":"ChatSystem.js","sources":["pages/detail/ChatSystem.vue","D:/Hbuild/HBuilderX.4.64.2025042916/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZGV0YWlsL0NoYXRTeXN0ZW0udnVl"],"sourcesContent":["<template>\n  <view class=\"system-message-page\">\n    <!-- 自定义导航栏 -->\n    <view class=\"custom-navbar\">\n      <view class=\"status-bar\" :style=\"{ height: statusBarHeight + 'px' }\"></view>\n      <view class=\"nav-content\">\n        <view class=\"nav-left\" @tap=\"goBack\">\n          <view class=\"back-btn\">\n            <text class=\"back-icon\">‹</text>\n          </view>\n        </view>\n        <view class=\"nav-center\">\n          <text class=\"nav-title\">系统消息</text>\n        </view>\n        <view class=\"nav-right\">\n          <!-- <view class=\"message-count\" v-if=\"MesStore.MessageList.length > 0\">\n            <text class=\"count-text\">{{ MesStore.MessageList.length }}</text>\n          </view> -->\n        </view>\n      </view>\n    </view>\n\n    <!-- 消息列表 -->\n    <scroll-view\n      class=\"message-list\"\n      :style=\"{ marginTop: statusBarHeight + 48 + 'px' }\"\n      scroll-y=\"true\"\n      :bounces=\"true\"\n      :refresher-enabled=\"true\"\n      :refresher-triggered=\"MesStore.refreshing\"\n      @refresherrefresh=\"handleRefresh\"\n      @refresherrestore=\"handleRefreshRestore\"\n      @scrolltolower=\"handleLoadMore\"\n      :lower-threshold=\"100\"\n    >\n      <view class=\"list-wrapper\">\n        <!-- 初始加载状态 -->\n        <view v-if=\"MesStore.loading && MesStore.MessageList.length === 0\" class=\"loading-container\">\n          <view class=\"loading-spinner\"></view>\n          <text class=\"loading-text\">正在加载消息...</text>\n        </view>\n\n        <!-- 消息列表 -->\n        <view v-else class=\"messages-container\">\n          <!-- 消息项 -->\n          <view \n            v-for=\"(message, index) in MesStore.MessageList\" \n            :key=\"message.id\"\n            class=\"message-item\"\n            :class=\"{ 'expanded': message.expanded }\"\n          >\n            <!-- 消息卡片 -->\n            <view class=\"message-card\" @tap=\"handleMessageClick(message, index)\">\n              <!-- 装饰线条 -->\n              <view class=\"decoration-line\"></view>\n              \n              <!-- 消息头部 -->\n              <view class=\"message-header\">\n                <view class=\"message-icon\">\n                  <text class=\"icon-text\">📢</text>\n                </view>\n                <view class=\"header-content\">\n                  <view class=\"title-line\">\n                    <text class=\"message-title\">{{ message.title || '系统通知' }}</text>\n                    <!-- 时间移到右上角 -->\n                    <text class=\"message-time\">{{ formatTime(message.send_time || message.created_at) }}</text>\n                  </view>\n                  <!-- 发送者信息（如果有） -->\n                  <view v-if=\"message.sender_name\" class=\"sender-info\">\n                    <text class=\"sender-name\">{{ message.sender_name }}</text>\n                  </view>\n                </view>\n              </view>\n\n              <!-- 消息内容区域 -->\n              <view class=\"message-body\">\n                <!-- 短内容直接显示 -->\n                <view v-if=\"getContentType(message.content) === 'short'\" class=\"content-wrapper\">\n                  <text class=\"content-text\">{{ message.content }}</text>\n                </view>\n\n                <!-- 中等长度内容可折叠 -->\n                <view v-else-if=\"getContentType(message.content) === 'medium'\" class=\"content-wrapper\">\n                  <text \n                    class=\"content-text\" \n                    :class=\"{ 'content-collapsed': !message.expanded }\"\n                  >\n                    {{ message.content }}\n                  </text>\n                  \n                  <!-- 折叠/展开控制 -->\n                  <view class=\"toggle-section\">\n                    <view class=\"fade-mask\" v-if=\"!message.expanded\"></view>\n                    <view class=\"toggle-btn\" @tap.stop=\"toggleContent(index)\">\n                      <text class=\"toggle-text\">{{ message.expanded ? '收起' : '展开' }}</text>\n                      <view class=\"toggle-icon\" :class=\"{ 'rotated': message.expanded }\">\n                        <text class=\"icon-arrow\">▼</text>\n                      </view>\n                    </view>\n                  </view>\n                </view>\n\n                <!-- 超长内容显示预览 -->\n                <view v-else class=\"content-wrapper\">\n                  <text class=\"content-preview\">{{ getPreviewText(message.content) }}</text>\n                  \n                  <view class=\"action-section\">\n                    <view class=\"detail-btn\" @tap.stop=\"viewFullContent(message)\">\n                      <view class=\"btn-content\">\n                        <text class=\"btn-text\">查看完整内容</text>\n                        <view class=\"btn-arrow\">\n                          <text class=\"arrow-icon\">→</text>\n                        </view>\n                      </view>\n                    </view>\n                  </view>\n                </view>\n\n                <!-- 消息状态栏 -->\n                <view class=\"message-status\" v-if=\"message.priority || message.category\">\n                  <view v-if=\"message.priority\" class=\"priority-tag\" :class=\"`priority-${message.priority}`\">\n                    <text class=\"priority-text\">{{ getPriorityText(message.priority) }}</text>\n                  </view>\n                  <view v-if=\"message.category\" class=\"category-tag\">\n                    <text class=\"category-text\">{{ message.category }}</text>\n                  </view>\n                </view>\n              </view>\n            </view>\n          </view>\n\n          <!-- 加载更多状态 -->\n          <view v-if=\"MesStore.hasMoreData && MesStore.MessageList.length > 0\" class=\"load-more-section\">\n            <view v-if=\"MesStore.loadingMore\" class=\"loading-more\">\n              <view class=\"loading-spinner small\"></view>\n              <text class=\"loading-text\">加载更多消息...</text>\n            </view>\n            <view v-else class=\"load-more-tip\">\n              <text class=\"tip-text\">上拉加载更多</text>\n            </view>\n          </view>\n\n          <!-- 无更多数据 -->\n          <view v-else-if=\"MesStore.MessageList.length > 0 && !MesStore.hasMoreData\" class=\"no-more-section\">\n            <view class=\"no-more-line\"></view>\n            <text class=\"no-more-text\">已显示全部消息</text>\n            <view class=\"no-more-line\"></view>\n          </view>\n        </view>\n\n        <!-- 空状态 -->\n        <view v-if=\"!MesStore.loading && MesStore.MessageList.length === 0\" class=\"empty-state\">\n          <view class=\"empty-illustration\">\n            <view class=\"empty-circle\">\n              <text class=\"empty-icon\">📭</text>\n            </view>\n          </view>\n          <text class=\"empty-title\">暂无系统消息</text>\n          <text class=\"empty-desc\">系统重要通知会在这里显示</text>\n          <view class=\"retry-btn\" v-if=\"MesStore.error\" @tap=\"handleRetry\">\n            <text class=\"retry-text\">重新加载</text>\n          </view>\n        </view>\n\n        <!-- 错误提示 -->\n        <view v-if=\"MesStore.error && MesStore.MessageList.length > 0\" class=\"error-banner\">\n          <view class=\"error-content\">\n            <text class=\"error-icon\">⚠️</text>\n            <text class=\"error-text\">{{ MesStore.error }}</text>\n            <view class=\"retry-small-btn\" @tap=\"handleRetry\">\n              <text class=\"retry-small-text\">重试</text>\n            </view>\n          </view>\n        </view>\n      </view>\n    </scroll-view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted, computed, nextTick } from 'vue'\nimport { onLoad, onShow, onHide } from '@dcloudio/uni-app'\nimport { useMesstore } from '@/store/mes.js'\n\n// 响应式数据\nconst statusBarHeight = ref(0)\nconst pageSize = ref(10)\nconst loadThrottle = ref(false) // 加载节流\n\n// 初始化pinia\nconst MesStore = useMesstore()\n\n// 内容长度配置\nconst CONTENT_CONFIG = {\n  SHORT_LIMIT: 80,     // 短内容限制（字符数）\n  MEDIUM_LIMIT: 300,   // 中等内容限制\n  PREVIEW_LENGTH: 120, // 预览内容长度\n  COLLAPSE_HEIGHT: 3   // 折叠时显示行数\n}\n\n// 优先级文本映射\nconst PRIORITY_MAP = {\n  'high': '重要',\n  'medium': '普通',\n  'low': '一般',\n  'urgent': '紧急'\n}\n\n// 生命周期\nonMounted(async () => {\n  const sysInfo = uni.getSystemInfoSync()\n  statusBarHeight.value = sysInfo.statusBarHeight || 0\n})\n\nonLoad(async (options) => {\n  await loadInitialMessages()\n})\n\nonShow(() => {\n  // 页面显示时可以做一些操作，比如刷新数据状态检查\n  console.log('系统消息页面显示')\n})\n\nonHide(() => {\n  // 页面隐藏时清除错误状态\n  if (MesStore.error) {\n    MesStore.error = null\n  }\n})\n\n// 初始加载消息\nconst loadInitialMessages = async () => {\n  try {\n    await MesStore.getMessageList({\n      message_type: 'SYSTEM',\n      page: 1,\n      page_size: pageSize.value\n    })\n  } catch (error) {\n    console.error('初始加载消息失败:', error)\n    uni.showToast({\n      title: '加载失败，请重试',\n      icon: 'none',\n      duration: 2000\n    })\n  }\n}\n\n// 优化的触底加载更多\nconst handleLoadMore = async () => {\n  // 防抖处理\n  if (loadThrottle.value || MesStore.loadingMore || !MesStore.hasMoreData) {\n    console.log('加载条件不满足:', {\n      throttle: loadThrottle.value,\n      loading: MesStore.loadingMore,\n      hasMore: MesStore.hasMoreData\n    })\n    return\n  }\n\n  loadThrottle.value = true\n  \n  try {\n    const result = await MesStore.loadMoreMessages({\n      message_type: 'SYSTEM',\n      page_size: pageSize.value\n    })\n    \n    if (result.success) {\n      console.log(`加载更多成功: 新增${result.data.length}条消息`)\n      \n      // 如果返回数据少于请求数量，说明已经到底了\n      if (result.data.length < pageSize.value) {\n        console.log('已加载所有数据')\n      }\n    }\n  } catch (error) {\n    console.error('加载更多失败:', error)\n    uni.showToast({\n      title: '加载失败，请重试',\n      icon: 'none',\n      duration: 2000\n    })\n  } finally {\n    // 延迟重置节流状态，避免频繁触发\n    setTimeout(() => {\n      loadThrottle.value = false\n    }, 1000)\n  }\n}\n\n// 优化的下拉刷新\nconst handleRefresh = async () => {\n  try {\n    const result = await MesStore.refreshMessageList({\n      message_type: 'SYSTEM',\n      page_size: pageSize.value\n    })\n    \n    if (result.success) {\n      console.log('刷新成功:', result.data.length, '条消息')\n      uni.showToast({\n        title: '刷新成功',\n        icon: 'success',\n        duration: 1500\n      })\n    }\n  } catch (error) {\n    console.error('刷新失败:', error)\n    uni.showToast({\n      title: '刷新失败',\n      icon: 'error',\n      duration: 2000\n    })\n  }\n}\n\nconst handleRefreshRestore = () => {\n  console.log('刷新完成')\n}\n\n// 重试加载\nconst handleRetry = async () => {\n  MesStore.error = null\n  await loadInitialMessages()\n}\n\n// 获取内容类型\nconst getContentType = (content) => {\n  if (!content) return 'short'\n  \n  const length = content.length\n  if (length <= CONTENT_CONFIG.SHORT_LIMIT) {\n    return 'short'\n  } else if (length <= CONTENT_CONFIG.MEDIUM_LIMIT) {\n    return 'medium'\n  } else {\n    return 'long'\n  }\n}\n\n// 获取预览文本\nconst getPreviewText = (content) => {\n  if (!content) return ''\n  return content.length > CONTENT_CONFIG.PREVIEW_LENGTH \n    ? content.substring(0, CONTENT_CONFIG.PREVIEW_LENGTH) + '...'\n    : content\n}\n\n// 获取优先级文本\nconst getPriorityText = (priority) => {\n  return PRIORITY_MAP[priority] || priority\n}\n\n// 消息点击处理\nconst handleMessageClick = async (message, index) => {\n  // 可以在这里添加其他点击处理逻辑\n  console.log('点击消息:', message.title)\n}\n\n// 切换内容展开/折叠\nconst toggleContent = async (index) => {\n  const message = MesStore.MessageList[index]\n  if (!message) return\n\n  // 切换展开状态\n  MesStore.toggleMessageExpanded(message.id)\n}\n\n// 查看完整内容\nconst viewFullContent = async (message) => {\n  // 跳转到消息详情页\n  uni.navigateTo({\n    url: `/pages/detail/SystemMesDetail?id=${message.id}&title=${encodeURIComponent(message.title || '系统消息')}`\n  })\n}\n\n// 格式化时间\nconst formatTime = (timeStr) => {\n  if (!timeStr) return ''\n  \n  try {\n    const time = new Date(timeStr)\n    const now = new Date()\n    const diff = now - time\n    \n    if (diff < 60000) {\n      return '刚刚'\n    } else if (diff < 3600000) {\n      return `${Math.floor(diff / 60000)}分钟前`\n    } else if (diff < 86400000) {\n      return `${Math.floor(diff / 3600000)}小时前`\n    } else if (diff < 604800000) {\n      return `${Math.floor(diff / 86400000)}天前`\n    } else {\n      const month = String(time.getMonth() + 1).padStart(2, '0')\n      const date = String(time.getDate()).padStart(2, '0')\n      const hours = String(time.getHours()).padStart(2, '0')\n      const minutes = String(time.getMinutes()).padStart(2, '0')\n      \n      if (time.getFullYear() === now.getFullYear()) {\n        return `${month}-${date} ${hours}:${minutes}`\n      } else {\n        return `${time.getFullYear()}-${month}-${date}`\n      }\n    }\n  } catch (error) {\n    return String(timeStr)\n  }\n}\n\n// 返回上一页\nconst goBack = () => {\n  uni.navigateBack()\n}\n</script>\n\n<style scoped>\n.system-message-page {\n  min-height: 100vh;\n  background: linear-gradient(180deg, #fff5f5 0%, #fef2f2 100%);\n}\n\n/* 导航栏 */\n.custom-navbar {\n  background: linear-gradient(135deg, #ef4444 0%, #dc2626 50%, #b91c1c 100%);\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  z-index: 1000;\n  box-shadow: 0 8rpx 32rpx rgba(239, 68, 68, 0.3);\n}\n\n.nav-content {\n  height: 88rpx;\n  display: flex;\n  align-items: center;\n  padding: 0 32rpx;\n}\n\n.nav-left, .nav-right {\n  width: 120rpx;\n  display: flex;\n  align-items: center;\n}\n\n.nav-right {\n  justify-content: flex-end;\n}\n\n.back-btn {\n  width: 64rpx;\n  height: 64rpx;\n  border-radius: 50%;\n  background: rgba(255, 255, 255, 0.2);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.3s ease;\n  backdrop-filter: blur(10rpx);\n}\n\n.back-btn:active {\n  background: rgba(255, 255, 255, 0.3);\n  transform: scale(0.95);\n}\n\n.back-icon {\n  font-size: 44rpx;\n  color: white;\n  font-weight: 300;\n  margin-left: -4rpx;\n}\n\n.nav-center {\n  flex: 1;\n  display: flex;\n  justify-content: center;\n}\n\n.nav-title {\n  font-size: 36rpx;\n  font-weight: 600;\n  color: white;\n  text-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.1);\n}\n\n.message-count {\n  background: rgba(255, 255, 255, 0.25);\n  border-radius: 20rpx;\n  padding: 8rpx 16rpx;\n  backdrop-filter: blur(10rpx);\n  border: 2rpx solid rgba(255, 255, 255, 0.3);\n}\n\n.count-text {\n  font-size: 24rpx;\n  color: white;\n  font-weight: 600;\n}\n\n/* 消息列表 */\n.message-list {\n  flex: 1;\n  height: 100vh;\n}\n\n.list-wrapper {\n  padding: 32rpx 24rpx 140rpx;\n}\n\n/* 加载状态 */\n.loading-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 400rpx;\n  gap: 32rpx;\n}\n\n.loading-spinner {\n  width: 64rpx;\n  height: 64rpx;\n  border: 4rpx solid rgba(239, 68, 68, 0.1);\n  border-left: 4rpx solid #ef4444;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n}\n\n.loading-spinner.small {\n  width: 48rpx;\n  height: 48rpx;\n  border-width: 3rpx;\n}\n\n@keyframes spin {\n  0% { transform: rotate(0deg); }\n  100% { transform: rotate(360deg); }\n}\n\n.loading-text {\n  font-size: 28rpx;\n  color: #9ca3af;\n  font-weight: 500;\n}\n\n/* 消息容器 */\n.messages-container {\n  display: flex;\n  flex-direction: column;\n  gap: 24rpx;\n}\n\n/* 消息项 */\n.message-item {\n  animation: fadeInUp 0.6s ease forwards;\n  opacity: 0;\n  transform: translateY(30rpx);\n}\n\n.message-item:nth-child(1) { animation-delay: 0.1s; }\n.message-item:nth-child(2) { animation-delay: 0.2s; }\n.message-item:nth-child(3) { animation-delay: 0.3s; }\n.message-item:nth-child(4) { animation-delay: 0.4s; }\n\n@keyframes fadeInUp {\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n/* 消息卡片 */\n.message-card {\n  background: white;\n  border-radius: 24rpx;\n  overflow: hidden;\n  box-shadow: 0 8rpx 32rpx rgba(239, 68, 68, 0.08);\n  border: 2rpx solid rgba(239, 68, 68, 0.05);\n  position: relative;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.message-card:active {\n  transform: translateY(-2rpx);\n  box-shadow: 0 12rpx 40rpx rgba(239, 68, 68, 0.12);\n  border-color: rgba(239, 68, 68, 0.1);\n}\n\n/* 装饰线条 */\n.decoration-line {\n  height: 6rpx;\n  background: linear-gradient(90deg, #ef4444 0%, #f87171 50%, #fca5a5 100%);\n}\n\n/* 消息头部 */\n.message-header {\n  display: flex;\n  align-items: flex-start;\n  padding: 32rpx 32rpx 16rpx;\n  position: relative;\n}\n\n.message-icon {\n  width: 80rpx;\n  height: 80rpx;\n  background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-right: 24rpx;\n  border: 3rpx solid rgba(239, 68, 68, 0.1);\n  flex-shrink: 0;\n}\n\n.icon-text {\n  font-size: 32rpx;\n}\n\n.header-content {\n  flex: 1;\n}\n\n.title-line {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  gap: 16rpx;\n  margin-bottom: 8rpx;\n}\n\n.message-title {\n  font-size: 32rpx;\n  font-weight: 700;\n  color: #1f2937;\n  line-height: 1.4;\n  letter-spacing: 0.5rpx;\n  flex: 1;\n}\n\n.message-time {\n  font-size: 22rpx;\n  color: #9ca3af;\n  font-weight: 500;\n  white-space: nowrap;\n  flex-shrink: 0;\n}\n\n.sender-info {\n  margin-top: 4rpx;\n}\n\n.sender-name {\n  font-size: 24rpx;\n  color: #6b7280;\n  font-weight: 500;\n}\n\n/* 消息内容 */\n.message-body {\n  padding: 0 32rpx 32rpx;\n}\n\n.content-wrapper {\n  position: relative;\n}\n\n.content-text {\n  font-size: 28rpx;\n  line-height: 1.8;\n  color: #374151;\n  text-align: justify;\n  word-break: break-word;\n}\n\n/* 折叠状态的内容 */\n.content-collapsed {\n  overflow: hidden;\n  display: -webkit-box;\n  -webkit-line-clamp: 3;\n  -webkit-box-orient: vertical;\n  position: relative;\n}\n\n/* ====== 优化后的展开收起按钮样式 ====== */\n\n/* 切换按钮区域 */\n.toggle-section {\n  position: relative;\n  margin-top: 32rpx;\n}\n\n.toggle-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 16rpx;\n  width: 100%;\n  background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);\n  backdrop-filter: blur(10rpx);\n  border: 2rpx solid rgba(239, 68, 68, 0.2);\n  padding: 24rpx 32rpx;\n  border-radius: 40rpx;\n  cursor: pointer;\n  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n  box-shadow: \n    0 8rpx 24rpx rgba(239, 68, 68, 0.15),\n    0 2rpx 6rpx rgba(0, 0, 0, 0.05);\n  position: relative;\n  overflow: hidden;\n  transform: translateZ(0); /* 硬件加速 */\n}\n\n/* 悬浮态光效 */\n.toggle-btn::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: -100%;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(\n    90deg, \n    transparent, \n    rgba(239, 68, 68, 0.1), \n    transparent\n  );\n  transition: left 0.6s ease;\n}\n\n.toggle-btn:active::before {\n  left: 100%;\n}\n\n/* 点击态效果 */\n.toggle-btn:active {\n  transform: translateY(2rpx) scale(0.98);\n  box-shadow: \n    0 4rpx 12rpx rgba(239, 68, 68, 0.2),\n    0 1rpx 3rpx rgba(0, 0, 0, 0.1);\n  border-color: rgba(239, 68, 68, 0.3);\n  background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);\n}\n\n/* 文字样式 */\n.toggle-text {\n  font-size: 28rpx;\n  color: #ef4444;\n  font-weight: 600;\n  letter-spacing: 0.5rpx;\n  z-index: 2;\n  position: relative;\n  transition: all 0.3s ease;\n}\n\n.toggle-btn:active .toggle-text {\n  color: #dc2626;\n}\n\n/* 图标容器 */\n.toggle-icon {\n  width: 44rpx;\n  height: 44rpx;\n  background: linear-gradient(135deg, #ef4444 0%, #f87171 100%);\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n  z-index: 2;\n  position: relative;\n  box-shadow: 0 4rpx 12rpx rgba(239, 68, 68, 0.3);\n}\n\n/* 旋转动画 */\n.toggle-icon.rotated {\n  transform: rotate(180deg);\n  background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);\n}\n\n/* 箭头图标 */\n.icon-arrow {\n  color: white;\n  font-size: 24rpx;\n  font-weight: bold;\n  transition: transform 0.3s ease;\n  line-height: 1;\n}\n\n/* 激活态图标效果 */\n.toggle-btn:active .toggle-icon {\n  transform: scale(0.9);\n  box-shadow: 0 2rpx 8rpx rgba(239, 68, 68, 0.4);\n}\n\n.toggle-btn:active .toggle-icon.rotated {\n  transform: rotate(180deg) scale(0.9);\n}\n\n/* 微动画增强 */\n@keyframes pulse-border {\n  0%, 100% {\n    border-color: rgba(239, 68, 68, 0.2);\n  }\n  50% {\n    border-color: rgba(239, 68, 68, 0.35);\n  }\n}\n\n.toggle-btn:hover {\n  animation: pulse-border 2s ease-in-out infinite;\n}\n\n/* 渐变遮罩优化 */\n.fade-mask {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  height: 80rpx;\n  background: linear-gradient(\n    to bottom,\n    transparent 0%,\n    rgba(255, 255, 255, 0.3) 30%,\n    rgba(255, 255, 255, 0.8) 70%,\n    white 100%\n  );\n  pointer-events: none;\n  border-radius: 0 0 12rpx 12rpx;\n}\n\n/* ====== 原有样式继续 ====== */\n\n/* 预览内容 */\n.content-preview {\n  font-size: 28rpx;\n  line-height: 1.8;\n  color: #374151;\n  text-align: justify;\n  margin-bottom: 24rpx;\n}\n\n/* 操作区域 */\n.action-section {\n  display: flex;\n  justify-content: center;\n}\n\n.detail-btn {\n  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\n  border-radius: 50rpx;\n  padding: 20rpx 32rpx;\n  box-shadow: 0 8rpx 24rpx rgba(239, 68, 68, 0.3);\n  transition: all 0.3s ease;\n}\n\n.detail-btn:active {\n  transform: scale(0.95);\n  box-shadow: 0 4rpx 16rpx rgba(239, 68, 68, 0.4);\n}\n\n.btn-content {\n  display: flex;\n  align-items: center;\n  gap: 12rpx;\n}\n\n.btn-text {\n  font-size: 28rpx;\n  color: white;\n  font-weight: 600;\n}\n\n.btn-arrow {\n  transition: transform 0.3s ease;\n}\n\n.detail-btn:active .btn-arrow {\n  transform: translateX(4rpx);\n}\n\n.arrow-icon {\n  font-size: 24rpx;\n  color: white;\n  font-weight: bold;\n}\n\n/* 消息状态栏 */\n.message-status {\n  display: flex;\n  gap: 16rpx;\n  margin-top: 20rpx;\n  flex-wrap: wrap;\n}\n\n.priority-tag {\n  padding: 8rpx 16rpx;\n  border-radius: 20rpx;\n  font-size: 22rpx;\n}\n\n.priority-high, .priority-urgent {\n  background: #fee2e2;\n  color: #dc2626;\n  border: 1rpx solid #fecaca;\n}\n\n.priority-medium {\n  background: #fef3c7;\n  color: #d97706;\n  border: 1rpx solid #fed7aa;\n}\n\n.priority-low {\n  background: #ecfdf5;\n  color: #059669;\n  border: 1rpx solid #a7f3d0;\n}\n\n.category-tag {\n  background: #f3f4f6;\n  color: #6b7280;\n  padding: 8rpx 16rpx;\n  border-radius: 20rpx;\n  border: 1rpx solid #e5e7eb;\n}\n\n.priority-text, .category-text {\n  font-size: 22rpx;\n  font-weight: 600;\n}\n\n/* 加载更多区域 */\n.load-more-section {\n  display: flex;\n  justify-content: center;\n  padding: 48rpx 0;\n}\n\n.loading-more {\n  display: flex;\n  align-items: center;\n  gap: 20rpx;\n}\n\n.load-more-tip {\n  padding: 16rpx 32rpx;\n  background: rgba(239, 68, 68, 0.05);\n  border-radius: 50rpx;\n  border: 2rpx solid rgba(239, 68, 68, 0.1);\n}\n\n.tip-text {\n  font-size: 26rpx;\n  color: #9ca3af;\n  font-weight: 500;\n}\n\n/* 无更多数据 */\n.no-more-section {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 24rpx;\n  padding: 48rpx 0;\n}\n\n.no-more-line {\n  flex: 1;\n  height: 2rpx;\n  background: linear-gradient(90deg, transparent, #fee2e2, transparent);\n}\n\n.no-more-text {\n  font-size: 26rpx;\n  color: #9ca3af;\n  font-weight: 500;\n  white-space: nowrap;\n}\n\n/* 错误提示 */\n.error-banner {\n  background: #fee2e2;\n  border: 2rpx solid #fecaca;\n  border-radius: 16rpx;\n  margin: 24rpx 0;\n  overflow: hidden;\n}\n\n.error-content {\n  display: flex;\n  align-items: center;\n  padding: 24rpx;\n  gap: 16rpx;\n}\n\n.error-icon {\n  font-size: 32rpx;\n}\n\n.error-text {\n  flex: 1;\n  font-size: 28rpx;\n  color: #dc2626;\n  font-weight: 500;\n}\n\n.retry-small-btn {\n  background: #dc2626;\n  color: white;\n  padding: 12rpx 24rpx;\n  border-radius: 20rpx;\n  transition: all 0.3s ease;\n}\n\n.retry-small-btn:active {\n  transform: scale(0.95);\n  background: #b91c1c;\n}\n\n.retry-small-text {\n  font-size: 24rpx;\n  color: white;\n  font-weight: 600;\n}\n\n/* 空状态 */\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 60vh;\n  gap: 32rpx;\n}\n\n.empty-illustration {\n  position: relative;\n}\n\n.empty-circle {\n  width: 200rpx;\n  height: 200rpx;\n  background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 50%, #fecaca 100%);\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n  animation: float 3s ease-in-out infinite;\n  box-shadow: 0 16rpx 48rpx rgba(239, 68, 68, 0.15);\n}\n\n.empty-circle::before {\n  content: '';\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  border-radius: 50%;\n  border: 4rpx solid rgba(239, 68, 68, 0.1);\n  animation: pulse 2s ease-in-out infinite;\n}\n\n@keyframes float {\n  0%, 100% { transform: translateY(0px); }\n  50% { transform: translateY(-10rpx); }\n}\n\n@keyframes pulse {\n  0%, 100% { \n    transform: scale(1);\n    opacity: 0.3;\n  }\n  50% { \n    transform: scale(1.1);\n    opacity: 0.1;\n  }\n}\n\n.empty-icon {\n  font-size: 80rpx;\n}\n\n.empty-title {\n  font-size: 36rpx;\n  font-weight: 700;\n  color: #374151;\n  text-align: center;\n}\n\n.empty-desc {\n  font-size: 28rpx;\n  color: #9ca3af;\n  text-align: center;\n  line-height: 1.6;\n  max-width: 400rpx;\n}\n\n.retry-btn {\n  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\n  border-radius: 50rpx;\n  padding: 20rpx 40rpx;\n  box-shadow: 0 8rpx 24rpx rgba(239, 68, 68, 0.3);\n  transition: all 0.3s ease;\n  margin-top: 16rpx;\n}\n\n.retry-btn:active {\n  transform: scale(0.95);\n  box-shadow: 0 4rpx 16rpx rgba(239, 68, 68, 0.4);\n}\n\n.retry-text {\n  font-size: 28rpx;\n  color: white;\n  font-weight: 600;\n}\n\n/* 响应式设计 */\n@media (max-width: 750rpx) {\n  .list-wrapper {\n    padding: 24rpx 16rpx 140rpx;\n  }\n  \n  .message-header {\n    padding: 24rpx 24rpx 12rpx;\n  }\n  \n  .message-body {\n    padding: 0 24rpx 24rpx;\n  }\n  \n  .message-icon {\n    width: 64rpx;\n    height: 64rpx;\n    margin-right: 16rpx;\n  }\n  \n  .icon-text {\n    font-size: 28rpx;\n  }\n  \n  .message-title {\n    font-size: 30rpx;\n  }\n  \n  .content-text, .content-preview {\n    font-size: 26rpx;\n  }\n  \n  .empty-circle {\n    width: 160rpx;\n    height: 160rpx;\n  }\n  \n  .empty-icon {\n    font-size: 64rpx;\n  }\n  \n  /* 响应式按钮 */\n  .toggle-btn {\n    padding: 20rpx 24rpx;\n  }\n  \n  .toggle-text {\n    font-size: 26rpx;\n  }\n  \n  .toggle-icon {\n    width: 36rpx;\n    height: 36rpx;\n  }\n  \n  .icon-arrow {\n    font-size: 20rpx;\n  }\n  \n  .fade-mask {\n    height: 60rpx;\n  }\n}\n\n/* 暗黑模式支持 */\n@media (prefers-color-scheme: dark) {\n  .system-message-page {\n    background: linear-gradient(180deg, #1a1a1a 0%, #0f0f0f 100%);\n  }\n  \n  .message-card {\n    background: #1f2937;\n    border-color: rgba(239, 68, 68, 0.2);\n    box-shadow: 0 8rpx 32rpx rgba(0, 0, 0, 0.3);\n  }\n  \n  .message-title {\n    color: #f9fafb;\n  }\n  \n  .content-text, .content-preview {\n    color: #d1d5db;\n  }\n  \n  .message-time, .sender-name {\n    color: #9ca3af;\n  }\n  \n  .message-icon {\n    background: linear-gradient(135deg, #2d1b1b 0%, #3c2626 100%);\n    border-color: rgba(239, 68, 68, 0.2);\n  }\n  \n  .empty-circle {\n    background: linear-gradient(135deg, #2d1b1b 0%, #3c2626 50%, #4a2c2c 100%);\n  }\n  \n  .empty-title {\n    color: #f9fafb;\n  }\n  \n  .error-banner {\n    background: #2d1b1b;\n    border-color: #3c2626;\n  }\n  \n  .error-text {\n    color: #f87171;\n  }\n  \n  /* 暗黑模式按钮 */\n  .toggle-btn {\n    background: linear-gradient(135deg, #2d1b1b 0%, #3c2626 100%);\n    border-color: rgba(239, 68, 68, 0.3);\n    box-shadow: \n      0 8rpx 24rpx rgba(0, 0, 0, 0.3),\n      0 2rpx 6rpx rgba(0, 0, 0, 0.1);\n  }\n  \n  .toggle-btn:active {\n    background: linear-gradient(135deg, #3c2626 0%, #4a2c2c 100%);\n    border-color: rgba(239, 68, 68, 0.4);\n  }\n  \n  .fade-mask {\n    background: linear-gradient(\n      to bottom,\n      transparent 0%,\n      rgba(31, 41, 55, 0.3) 30%,\n      rgba(31, 41, 55, 0.8) 70%,\n      #1f2937 100%\n    );\n  }\n}\n\n/* 无障碍支持 */\n@media (prefers-reduced-motion: reduce) {\n  .message-item,\n  .empty-circle,\n  .loading-spinner {\n    animation: none;\n  }\n  \n  .message-card,\n  .detail-btn {\n    transition: none;\n  }\n  \n  /* 按钮无障碍 */\n  .toggle-btn,\n  .toggle-icon,\n  .toggle-text,\n  .icon-arrow {\n    transition: none;\n  }\n  \n  .toggle-btn::before {\n    display: none;\n  }\n  \n  .toggle-btn:hover {\n    animation: none;\n  }\n}\n\n/* 高对比度模式 */\n@media (prefers-contrast: high) {\n  .toggle-btn {\n    border-width: 4rpx;\n    border-color: #ef4444;\n    background: #fef2f2;\n  }\n  \n  .toggle-text {\n    color: #dc2626;\n    font-weight: 700;\n  }\n}\n</style>","import MiniProgramPage from 'E:/project/uniapp/uniapp-news/pages/detail/ChatSystem.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","useMesstore","onMounted","uni","onLoad","onShow","onHide"],"mappings":"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"}