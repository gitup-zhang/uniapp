{"version":3,"file":"news.js","sources":["pages/news/news.vue","D:/Hbuild/HBuilderX.4.64.2025042916/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbmV3cy9uZXdzLnZ1ZQ"],"sourcesContent":["<template> \n  <view class=\"page\">\n    <!-- 顶部固定导航栏 -->\n    <uni-nav-bar statusBar=\"true\" backgroundColor=\"#903749\" fixed=\"true\">\n      <template v-slot:left>\n        <view class=\"navbar-title\">新闻</view>\n      </template>\n    </uni-nav-bar>\n\n    <!-- 搜索栏 + 筛选栏固定区域 -->\n    <view class=\"fixed-top\">\n      <uni-search-bar \n        @confirm=\"search\" \n        placeholder=\"搜索行业新闻\" \n        v-model=\"searchbar\" \n        @cancel=\"cancel\">\n      </uni-search-bar>\n\n      <view class=\"filter-wrapper\">\n        <view class=\"filter-bar\">\n          <!-- 领域筛选 -->\n          <view class=\"filter-item\" @click=\"toggleDropdown('domain')\">\n            {{ selectedDomain?.field_name || '全部领域' }}\n            <view class=\"arrow\" :class=\"{ open: currentDropdown === 'domain' }\"></view>\n          </view>\n\n          <!-- 时间筛选 -->\n          <view class=\"filter-item\" @click=\"toggleDropdown('time')\">\n            {{ selectedTime }}\n            <view class=\"arrow\" :class=\"{ open: currentDropdown === 'time' }\"></view>\n          </view>\n        </view>\n\n        <!-- 领域下拉菜单 -->\n        <view v-if=\"currentDropdown === 'domain'\" class=\"dropdown-list\">\n          <!-- 全部选项 -->\n          <view \n            class=\"dropdown-item\" \n            @click=\"selectOption('domain', null)\" \n            :class=\"{ selected: selectedDomain === null }\"\n          >\n            全部\n          </view>\n          <!-- 具体领域项 -->\n          <view \n            class=\"dropdown-item\" \n            v-for=\"item in field.fieldlist\" \n            :key=\"item.field_id\"\n            @click=\"selectOption('domain', item)\" \n            :class=\"{ selected: selectedDomain?.field_id === item.field_id }\"\n          >\n            {{ item.field_name }}\n          </view>\n        </view>\n\n        <!-- 时间下拉菜单 -->\n        <view v-if=\"currentDropdown === 'time'\" class=\"dropdown-list\">\n          <view \n            class=\"dropdown-item\" \n            v-for=\"item in timeList\" \n            :key=\"item\"\n            @click=\"selectOption('time', item)\" \n            :class=\"{ selected: selectedTime === item }\"\n          >\n            {{ item }}\n          </view>\n        </view>\n      </view>\n    </view>\n\n    <!-- 新闻列表区域 -->\n    <scroll-view class=\"news-scroll\" scroll-y=\"true\">\n      <view>\n        <uni-card\n          v-for=\"item in listnew.listnew\"\n          :key=\"item.id\"\n          :title=\"item.new_title\"\n          :extra=\"Dataformat(item.release_time)\"\n          :thumbnail=\"item.list_image_url\"\n          @click=\"onClick(item.id)\"\n        >\n          <text class=\"uni-body\">{{ item.brief_content }}</text>\n        </uni-card>\n      </view>\n    </scroll-view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport { useNewStore } from '../../store/NewList'\nimport { usefieldstore } from '../../store/field.js'\nimport { Dataformat } from '../../utils/data'\n\n// 从 Pinia 获取 store\nconst listnew = useNewStore()\nconst field = usefieldstore()\n\n// 搜索框内容\nconst searchbar = ref(\"\")\n\n// 当前打开的下拉框类型（'domain' | 'time'）\nconst currentDropdown = ref(null)\n\n// 当前选中的领域（对象或 null）和时间（字符串）\nconst selectedDomain = ref(null)\nconst selectedTime = ref('发布时间')\n\n// 时间列表\nconst timeList = ['全部', '最近一周', '最近一月', '最近一年']\n\n// 搜索\nfunction search() {\n  listnew.searchnewlist({ newTitle: searchbar.value })\n  console.log(\"搜索关键词:\", searchbar.value)\n}\n\n// 取消搜索\nfunction cancel() {\n  searchbar.value = \"\"\r\n  listnew.getlistnew()\n}\n\n// 切换下拉框显示\nfunction toggleDropdown(type) {\n  currentDropdown.value = currentDropdown.value === type ? null : type\n}\n\n// 选择选项后处理\nfunction selectOption(type, value) {\n  if (type === 'domain') {\n    selectedDomain.value = value\n    if (value === null) {\n      console.log(\"选中全部领域\")\n      listnew.getlistnew()\n      \n    } else {\r\n\tlistnew.searchnewlist({ 'fieldID': value.field_id})\r\n\t\t\n      console.log(\"选中领域ID:\", value.field_id)\n      // 可选：根据字段筛选\n      // listnew.searchnewlist({ fieldId: value.field_id })\n    }\n  }\n\n  if (type === 'time') {\n    selectedTime.value = value\n  }\n\n  currentDropdown.value = null\n}\n\n// 点击新闻项跳转详情页\nfunction onClick(id) {\n  uni.navigateTo({\n    url: `/pages/detail/detailnew?id=${id}`\n  })\n}\n\n// 页面挂载时加载新闻和领域列表\nonMounted(() => {\n  listnew.getlistnew()\n  field.getfield()\n})\n</script>\n\n<style>\n@import url(\"../../style/new_policy.css\");\n\n.dropdown-list {\n  background-color: #fff;\n  border: 1px solid #ccc;\n  border-radius: 4rpx;\n  margin-top: 10rpx;\n}\n\n.dropdown-item {\n  padding: 20rpx;\n  font-size: 28rpx;\n  color: #333;\n}\n\n.dropdown-item.selected {\n  background-color: #f0f0f0;\n  font-weight: bold;\n}\n\n.filter-item {\n  /* padding: 20rpx;\n  font-size: 30rpx; */\r\n   padding: 12rpx 20rpx;\r\n   font-size: 30rpx;\r\n   display: flex;\r\n   align-items: center;\r\n   justify-content: space-between;\n}\n\n.arrow.open {\n  transform: rotate(180deg);\n}\n</style>\n","import MiniProgramPage from 'E:/project/uniapp/uniapp-news/pages/news/news.vue'\nwx.createPage(MiniProgramPage)"],"names":["useNewStore","usefieldstore","ref","uni","onMounted","MiniProgramPage"],"mappings":";;;;;;;;;;;;;;;;;;;;AA+FA,UAAM,UAAUA,cAAAA,YAAa;AAC7B,UAAM,QAAQC,YAAAA,cAAe;AAG7B,UAAM,YAAYC,cAAG,IAAC,EAAE;AAGxB,UAAM,kBAAkBA,cAAG,IAAC,IAAI;AAGhC,UAAM,iBAAiBA,cAAG,IAAC,IAAI;AAC/B,UAAM,eAAeA,cAAG,IAAC,MAAM;AAG/B,UAAM,WAAW,CAAC,MAAM,QAAQ,QAAQ,MAAM;AAG9C,aAAS,SAAS;AAChB,cAAQ,cAAc,EAAE,UAAU,UAAU,MAAK,CAAE;AACnDC,oBAAY,MAAA,MAAA,OAAA,8BAAA,UAAU,UAAU,KAAK;AAAA,IACvC;AAGA,aAAS,SAAS;AAChB,gBAAU,QAAQ;AAClB,cAAQ,WAAY;AAAA,IACtB;AAGA,aAAS,eAAe,MAAM;AAC5B,sBAAgB,QAAQ,gBAAgB,UAAU,OAAO,OAAO;AAAA,IAClE;AAGA,aAAS,aAAa,MAAM,OAAO;AACjC,UAAI,SAAS,UAAU;AACrB,uBAAe,QAAQ;AACvB,YAAI,UAAU,MAAM;AAClBA,wBAAAA,MAAY,MAAA,OAAA,8BAAA,QAAQ;AACpB,kBAAQ,WAAY;AAAA,QAE1B,OAAW;AACV,kBAAQ,cAAc,EAAE,WAAW,MAAM,SAAQ,CAAC;AAE7CA,wBAAA,MAAA,MAAA,OAAA,8BAAY,WAAW,MAAM,QAAQ;AAAA,QAGtC;AAAA,MACF;AAED,UAAI,SAAS,QAAQ;AACnB,qBAAa,QAAQ;AAAA,MACtB;AAED,sBAAgB,QAAQ;AAAA,IAC1B;AAGA,aAAS,QAAQ,IAAI;AACnBA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,8BAA8B,EAAE;AAAA,MACzC,CAAG;AAAA,IACH;AAGAC,kBAAAA,UAAU,MAAM;AACd,cAAQ,WAAY;AACpB,YAAM,SAAU;AAAA,IAClB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClKD,GAAG,WAAWC,SAAe;"}