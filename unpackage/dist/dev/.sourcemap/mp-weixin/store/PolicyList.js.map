{"version":3,"file":"PolicyList.js","sources":["store/PolicyList.js"],"sourcesContent":["import { defineStore } from 'pinia'\nimport { ref } from 'vue'\nimport { getPolicyList,getPolicyField } from '@/new-apis/policy.js'\n\nexport const usePolicyStore = defineStore('policylist', () => {\r\n\t// 获取的列表\n  const listpolicy = ref([])\r\n  const page =ref(1)\r\n\r\n  // 是否正确返回信息标志位与信息\r\n  const message=ref(\"\")\r\n    // 加载状态\r\n    const loading = ref(false)\r\n    const hasMore = ref(true)\r\n\n\n  const getlistpolicy = async (params) => {\n    uni.showLoading({\n      title: '加载中...',\n      mask: true\n    })\n\n    try {\r\n\t\tmessage.value=\"\"\r\n\t\n      const res = await getPolicyList(params)  // 正确使用 await\n      console.log('示例数据：', res.data)\r\n\t  page.value=res.page\r\n\t  if(res.page*res.page_size<res.total){\r\n\t\t  hasMore.value=true\r\n\t  }else{\r\n\t\t  hasMore.value=false\r\n\t  }\r\n\t  console.log(hasMore.value)\r\n\t  \r\n\t  \n      listpolicy.value = res.data           // 正常赋值\n    } catch (error) {\r\n\t\tmessage.value=error.data.error\n      console.log(message.value)\n    } finally {\n      uni.hideLoading()\n    }\n  }\r\n  \r\n  const getmorelist=async(parma)=>{\r\n\t  if(loading.value||!hasMore.value) return\r\n\t  \r\n\t  \r\n\t  try{\r\n\t\t loading.value=true \r\n\t\t \r\n\t\tconst res = await getPolicyList(parma)\r\n\t\tpage.value=res.page\r\n\t\tif(res.page*res.page_size<res.total){\r\n\t\t\t\t  hasMore.value=true\r\n\t\t}else{\r\n\t\t\t\t  hasMore.value=false\r\n\t\t}\r\n\t\t// 拼接新数据\r\n\t\tlistpolicy.value=listpolicy.value.concat(res.data)\r\n\t  }catch(error){\r\n\t\t  \r\n\t  }finally{\r\n\t\t  loading.value=false\r\n\t  }\r\n\t\r\n\t  \r\n\t  \r\n\t  \r\n  }\r\n  \r\n  \r\n  // 搜索框\r\n  const searchpolicy=async(params)=>{\r\n\t  \r\n\t  uni.showLoading({\r\n\t    title: '加载中...',\r\n\t    mask: true\r\n\t  })\r\n\t  \r\n\t  try {\r\n\t  \tmessage.value=\"\"\r\n\r\n\t    const res = await getPolicyList(params) \r\n\t\tpage.value=res.page\r\n\t\tif(res.page*res.page_size<res.total){\r\n\t\t\t\t  hasMore.value=true\r\n\t\t}else{\r\n\t\t\t\t  hasMore.value=false\r\n\t\t}\r\n\t\t\r\n\t    console.log('示例数据：', res.data)\r\n\t    listpolicy.value = res.data           // 正常赋值\r\n\t  } catch (error) {\r\n\r\n\t\t  console.log(error)\r\n\t  \t// message.value=error.data.error\r\n\t   //  console.log(message.value)\r\n\t  } finally {\r\n\t    uni.hideLoading()\r\n\t  }\r\n  }\n\n  return {\n    getlistpolicy,\n    listpolicy,\r\n\tmessage,\r\n\tsearchpolicy,\r\n\tgetmorelist,\r\n\tloading,\r\n\thasMore,\r\n\tpage\n  }\n})\n"],"names":["defineStore","ref","uni","getPolicyList"],"mappings":";;;AAIY,MAAC,iBAAiBA,cAAAA,YAAY,cAAc,MAAM;AAE5D,QAAM,aAAaC,cAAG,IAAC,EAAE;AACzB,QAAM,OAAMA,cAAG,IAAC,CAAC;AAGjB,QAAM,UAAQA,cAAG,IAAC,EAAE;AAElB,QAAM,UAAUA,cAAG,IAAC,KAAK;AACzB,QAAM,UAAUA,cAAG,IAAC,IAAI;AAG1B,QAAM,gBAAgB,OAAO,WAAW;AACtCC,kBAAAA,MAAI,YAAY;AAAA,MACd,OAAO;AAAA,MACP,MAAM;AAAA,IACZ,CAAK;AAED,QAAI;AACN,cAAQ,QAAM;AAEV,YAAM,MAAM,MAAMC,eAAa,cAAC,MAAM;AACtCD,oEAAY,SAAS,IAAI,IAAI;AAChC,WAAK,QAAM,IAAI;AACf,UAAG,IAAI,OAAK,IAAI,YAAU,IAAI,OAAM;AACnC,gBAAQ,QAAM;AAAA,MAClB,OAAQ;AACJ,gBAAQ,QAAM;AAAA,MACd;AACDA,oBAAAA,MAAA,MAAA,OAAA,6BAAY,QAAQ,KAAK;AAGtB,iBAAW,QAAQ,IAAI;AAAA,IACxB,SAAQ,OAAO;AAClB,cAAQ,QAAM,MAAM,KAAK;AACrBA,oBAAAA,MAAA,MAAA,OAAA,6BAAY,QAAQ,KAAK;AAAA,IAC/B,UAAc;AACRA,oBAAAA,MAAI,YAAa;AAAA,IAClB;AAAA,EACF;AAED,QAAM,cAAY,OAAM,UAAQ;AAC/B,QAAG,QAAQ,SAAO,CAAC,QAAQ;AAAO;AAGlC,QAAG;AACH,cAAQ,QAAM;AAEf,YAAM,MAAM,MAAMC,eAAa,cAAC,KAAK;AACrC,WAAK,QAAM,IAAI;AACf,UAAG,IAAI,OAAK,IAAI,YAAU,IAAI,OAAM;AAChC,gBAAQ,QAAM;AAAA,MACpB,OAAO;AACD,gBAAQ,QAAM;AAAA,MACjB;AAED,iBAAW,QAAM,WAAW,MAAM,OAAO,IAAI,IAAI;AAAA,IAC/C,SAAM,OAAM;AAAA,IAEhB,UAAI;AACA,cAAQ,QAAM;AAAA,IACd;AAAA,EAKD;AAID,QAAM,eAAa,OAAM,WAAS;AAEjCD,kBAAAA,MAAI,YAAY;AAAA,MACd,OAAO;AAAA,MACP,MAAM;AAAA,IACX,CAAI;AAED,QAAI;AACH,cAAQ,QAAM;AAEb,YAAM,MAAM,MAAMC,eAAa,cAAC,MAAM;AACzC,WAAK,QAAM,IAAI;AACf,UAAG,IAAI,OAAK,IAAI,YAAU,IAAI,OAAM;AAChC,gBAAQ,QAAM;AAAA,MACpB,OAAO;AACD,gBAAQ,QAAM;AAAA,MACjB;AAEED,oEAAY,SAAS,IAAI,IAAI;AAC7B,iBAAW,QAAQ,IAAI;AAAA,IACxB,SAAQ,OAAO;AAEfA,oBAAAA,MAAY,MAAA,OAAA,6BAAA,KAAK;AAAA,IAGrB,UAAa;AACRA,oBAAAA,MAAI,YAAa;AAAA,IAClB;AAAA,EACD;AAED,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACH;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACE;AACH,CAAC;;"}