{"version":3,"file":"NewList.js","sources":["store/NewList.js"],"sourcesContent":["import { defineStore } from 'pinia'\nimport { ref } from 'vue'\r\nimport { getNewList} from '@/new-apis/new.js'\r\n\r\nexport const useNewStore=defineStore('newlist',()=>{\r\n\t// 获取的列表\r\n\tconst listnew=ref([])\r\n\tconst page =ref(1)\r\n\t// 加载状态\r\n\tconst loading = ref(false)\r\n\tconst hasMore = ref(true)\r\n\t\r\n\tconst getlistnew=async(parmas)=>{\r\n\t\tuni.showLoading({\r\n\t\t  title: '加载中...',\r\n\t\t  mask: true\r\n\t\t})\r\n\t\ttry{\r\n\t\t\tconsole.log(listnew)\r\n\t\t\tconst res=await getNewList(parmas)\r\n\t\t\tpage.value=res.page\r\n\t\t\tif(res.page*res.page_size<res.total){\r\n\t\t\t\t\t  hasMore.value=true\r\n\t\t\t}else{\r\n\t\t\t\t\t  hasMore.value=false\r\n\t\t\t}\r\n\t\t\tconsole.log(hasMore.value)\r\n\t\t\tlistnew.value=res.data\r\n\t\t\t\r\n\t\t}catch(error){\r\n\t\t\tconsole.log(error)\r\n\t\t}finally{\r\n\t\t\t\r\n\t\t\tuni.hideLoading()\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\t// 加载更多\r\n\tconst getmorelist=async(parma)=>{\r\n\t\tif(loading.value||!hasMore.value) return\r\n\t\ttry{\r\n\t\t\t\t loading.value=true \r\n\t\t\t\t \r\n\t\t\t\tconst res = await getNewList(parma)\r\n\t\t\t\tpage.value=res.page\r\n\t\t\t\tif(res.page*res.page_size<res.total){\r\n\t\t\t\t\t\t  hasMore.value=true\r\n\t\t\t\t}else{\r\n\t\t\t\t\t\t  hasMore.value=false\r\n\t\t\t\t}\r\n\t\t\t\t// 拼接新数据\r\n\t\t\t\tlistnew.value=listnew.value.concat(res.data)\r\n\t\t}catch(error){\r\n\t\t\t\t  \r\n\t\t}finally{\r\n\t\t\t\t  loading.value=false\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t// 搜索功能\r\n\tconst searchnewlist=async(params)=>{\r\n\t\t\r\n\t\tuni.showLoading({\r\n\t\t  title: '加载中...',\r\n\t\t  mask: true\r\n\t\t})\r\n\t\ttry{\r\n\t\t\tconsole.log(listnew)\r\n\t\t\tconst res=await getNewList(params)\r\n\t\t\tpage.value=res.page\r\n\t\t\tif(res.page*res.page_size<res.total){\r\n\t\t\t\t\t  hasMore.value=true\r\n\t\t\t}else{\r\n\t\t\t\t\t  hasMore.value=false\r\n\t\t\t}\r\n\t\t\tlistnew.value=res.data\r\n\t\t\t\r\n\t\t}catch(error){\r\n\t\t\tconsole.log(error)\r\n\t\t}finally{\r\n\t\t\t\r\n\t\t\tuni.hideLoading()\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\treturn{\r\n\t\tlistnew,\r\n\t\tgetlistnew,\r\n\t\tsearchnewlist,\r\n\t\tgetmorelist,\r\n\t\tloading,\r\n\t\thasMore,\r\n\t\tpage\r\n\t\t\r\n\t}\r\n})\r\n"],"names":["defineStore","ref","uni","getNewList"],"mappings":";;;AAIY,MAAC,cAAYA,cAAAA,YAAY,WAAU,MAAI;AAElD,QAAM,UAAQC,cAAG,IAAC,EAAE;AACpB,QAAM,OAAMA,cAAG,IAAC,CAAC;AAEjB,QAAM,UAAUA,cAAG,IAAC,KAAK;AACzB,QAAM,UAAUA,cAAG,IAAC,IAAI;AAExB,QAAM,aAAW,OAAM,WAAS;AAC/BC,kBAAAA,MAAI,YAAY;AAAA,MACd,OAAO;AAAA,MACP,MAAM;AAAA,IACV,CAAG;AACD,QAAG;AACFA,oBAAAA,MAAA,MAAA,OAAA,0BAAY,OAAO;AACnB,YAAM,MAAI,MAAMC,YAAU,WAAC,MAAM;AACjC,WAAK,QAAM,IAAI;AACf,UAAG,IAAI,OAAK,IAAI,YAAU,IAAI,OAAM;AAChC,gBAAQ,QAAM;AAAA,MACrB,OAAQ;AACD,gBAAQ,QAAM;AAAA,MACjB;AACDD,oBAAAA,MAAA,MAAA,OAAA,0BAAY,QAAQ,KAAK;AACzB,cAAQ,QAAM,IAAI;AAAA,IAElB,SAAM,OAAM;AACZA,oBAAAA,MAAY,MAAA,OAAA,0BAAA,KAAK;AAAA,IACpB,UAAG;AAEAA,oBAAAA,MAAI,YAAa;AAAA,IACjB;AAAA,EAID;AAED,QAAM,cAAY,OAAM,UAAQ;AAC/B,QAAG,QAAQ,SAAO,CAAC,QAAQ;AAAO;AAClC,QAAG;AACA,cAAQ,QAAM;AAEf,YAAM,MAAM,MAAMC,YAAU,WAAC,KAAK;AAClC,WAAK,QAAM,IAAI;AACf,UAAG,IAAI,OAAK,IAAI,YAAU,IAAI,OAAM;AAChC,gBAAQ,QAAM;AAAA,MACtB,OAAS;AACD,gBAAQ,QAAM;AAAA,MACjB;AAED,cAAQ,QAAM,QAAQ,MAAM,OAAO,IAAI,IAAI;AAAA,IAC5C,SAAM,OAAM;AAAA,IAEf,UAAG;AACG,cAAQ,QAAM;AAAA,IACjB;AAAA,EAED;AAID,QAAM,gBAAc,OAAM,WAAS;AAElCD,kBAAAA,MAAI,YAAY;AAAA,MACd,OAAO;AAAA,MACP,MAAM;AAAA,IACV,CAAG;AACD,QAAG;AACFA,oBAAAA,MAAA,MAAA,OAAA,0BAAY,OAAO;AACnB,YAAM,MAAI,MAAMC,YAAU,WAAC,MAAM;AACjC,WAAK,QAAM,IAAI;AACf,UAAG,IAAI,OAAK,IAAI,YAAU,IAAI,OAAM;AAChC,gBAAQ,QAAM;AAAA,MACrB,OAAQ;AACD,gBAAQ,QAAM;AAAA,MACjB;AACD,cAAQ,QAAM,IAAI;AAAA,IAElB,SAAM,OAAM;AACZD,oBAAAA,MAAY,MAAA,OAAA,0BAAA,KAAK;AAAA,IACpB,UAAG;AAEAA,oBAAAA,MAAI,YAAa;AAAA,IACjB;AAAA,EAED;AAED,SAAM;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EAEA;AACF,CAAC;;"}