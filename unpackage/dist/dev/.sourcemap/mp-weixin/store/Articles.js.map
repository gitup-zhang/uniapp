{"version":3,"file":"Articles.js","sources":["store/Articles.js"],"sourcesContent":["import { defineStore } from 'pinia'\nimport { ref } from 'vue'\r\nimport {getArticleList} from '@/new-apis/articles.js'\r\n\r\nexport const useArticlesStore=defineStore('articlelist',()=>{\r\n\t// 获取到的政策列表\r\n\tconst listpolicy=ref([])\r\n\tconst page=ref(1)\r\n\t// 获取到的新闻列表\r\n\tconst listnew=ref([])\r\n\tconst pagenew=ref(1)\r\n\t\r\n\t// 加载状态\r\n\tconst loading = ref(false)\r\n\tconst hasMore = ref(true)\r\n\t\r\n\r\n\t\r\n\t// 获取政策列表\r\n\tconst getlistpolicy=async(params)=>{\r\n  let signal = params.article_type; \n\r\n\t\t loading.value=false\r\n\t\t hasMore.value=true\r\n\t\t\r\n\t\tuni.showLoading({\r\n\t\t  title: '加载中...',\r\n\t\t  mask: true\r\n\t\t})\r\n\t\ttry{\r\n\t\t\tconst res=await getArticleList(params)\r\n\t\t\tpage.value=res.page\r\n\t\t\tif(res.page*res.page_size<res.total){\r\n\t\t\t\t\t  hasMore.value=true\r\n\t\t\t}else{\r\n\t\t\t\t\t  hasMore.value=false\r\n\t\t\t}\r\n\t\t\tif(signal===\"POLICY\"){\r\n\r\n\t\t\tlistpolicy.value = res.data\r\n\t\t\t }\r\n\t\t\t else{\r\n\t\t\t\r\n\t\t\tlistnew.value=res.data\r\n\t\t\t }\r\n\t\t}catch(error){\r\n\t\t\t\r\n\t\t\tconsole.log(error)\r\n\t\t}finally{\r\n\t\t\r\n\t\t\tuni.hideLoading()\r\n\t\t}\r\n\t\t\r\n\t}\r\n\tconst getarticlemore=async(params)=>{\r\n\t\tlet signal = params.article_type; \r\n\t\t\r\n\t\t\r\n\t\tif(loading.value||!hasMore.value) return\r\n\t\t\r\n\t\t\r\n\t\ttry{\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\t loading.value=true \r\n\t\t\t\t \r\n\t\t\t\tconst res = await getArticleList(params)\r\n\t\t\t\tpage.value=res.page\r\n\t\t\t\tif(res.page*res.page_size<res.total){\r\n\t\t\t\t\t\t  hasMore.value=true\r\n\t\t\t\t}else{\r\n\t\t\t\t\t\t  hasMore.value=false\r\n\t\t\t\t}\r\n\t\t\t\t// 拼接新数据\r\n\t\t\t\tif(signal===\"POLICY\"){\r\n\t\t\t\t\t\r\n\t\t\t\tlistpolicy.value=listpolicy.value.concat(res.data)\r\n\t\t\t\t }\r\n\t\t\t\t else{\r\n\t\t\t\t\t \r\n\t\t\t\tlistnew.value=listnew.value.concat(res.data)\r\n\t\t\t\t }\r\n\t\t\t\t\r\n\t\t}catch(error){\r\n\t\t\tconsole.log(error)\r\n\t\t\t\t  \r\n\t\t}finally{\r\n\t\t\t\t  loading.value=false\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t// 重置page页码和加载状态\r\n\tfunction resetpage(num){\r\n\t\tpage.value=num\r\n\t\tloading.value=false\r\n\t\thasMore.value=true\r\n\t}\r\n\t\r\n\treturn {\r\n\tlistpolicy,\r\n\tpage,\r\n\tloading,\r\n\thasMore,\r\n\tgetlistpolicy,\r\n\tgetarticlemore,\r\n\tlistnew,\r\n\tresetpage\r\n\t}\r\n\t\r\n\t\r\n})\r\n"],"names":["defineStore","ref","uni","getArticleList"],"mappings":";;;AAIY,MAAC,mBAAiBA,cAAAA,YAAY,eAAc,MAAI;AAE3D,QAAM,aAAWC,cAAG,IAAC,EAAE;AACvB,QAAM,OAAKA,cAAG,IAAC,CAAC;AAEhB,QAAM,UAAQA,cAAG,IAAC,EAAE;AACNA,gBAAAA,IAAI,CAAC;AAGnB,QAAM,UAAUA,cAAG,IAAC,KAAK;AACzB,QAAM,UAAUA,cAAG,IAAC,IAAI;AAKxB,QAAM,gBAAc,OAAM,WAAS;AAClC,QAAI,SAAS,OAAO;AAEnB,YAAQ,QAAM;AACd,YAAQ,QAAM;AAEfC,kBAAAA,MAAI,YAAY;AAAA,MACd,OAAO;AAAA,MACP,MAAM;AAAA,IACV,CAAG;AACD,QAAG;AACF,YAAM,MAAI,MAAMC,iBAAc,eAAC,MAAM;AACrC,WAAK,QAAM,IAAI;AACf,UAAG,IAAI,OAAK,IAAI,YAAU,IAAI,OAAM;AAChC,gBAAQ,QAAM;AAAA,MACrB,OAAQ;AACD,gBAAQ,QAAM;AAAA,MACjB;AACD,UAAG,WAAS,UAAS;AAErB,mBAAW,QAAQ,IAAI;AAAA,MACrB,OACG;AAEL,gBAAQ,QAAM,IAAI;AAAA,MAChB;AAAA,IACF,SAAM,OAAM;AAEZD,oBAAAA,MAAY,MAAA,OAAA,2BAAA,KAAK;AAAA,IACpB,UAAG;AAEAA,oBAAAA,MAAI,YAAa;AAAA,IACjB;AAAA,EAED;AACD,QAAM,iBAAe,OAAM,WAAS;AACnC,QAAI,SAAS,OAAO;AAGpB,QAAG,QAAQ,SAAO,CAAC,QAAQ;AAAO;AAGlC,QAAG;AAGA,cAAQ,QAAM;AAEf,YAAM,MAAM,MAAMC,iBAAc,eAAC,MAAM;AACvC,WAAK,QAAM,IAAI;AACf,UAAG,IAAI,OAAK,IAAI,YAAU,IAAI,OAAM;AAChC,gBAAQ,QAAM;AAAA,MACtB,OAAS;AACD,gBAAQ,QAAM;AAAA,MACjB;AAED,UAAG,WAAS,UAAS;AAErB,mBAAW,QAAM,WAAW,MAAM,OAAO,IAAI,IAAI;AAAA,MAC/C,OACG;AAEL,gBAAQ,QAAM,QAAQ,MAAM,OAAO,IAAI,IAAI;AAAA,MACzC;AAAA,IAEH,SAAM,OAAM;AACZD,oBAAAA,MAAY,MAAA,OAAA,2BAAA,KAAK;AAAA,IAEpB,UAAG;AACG,cAAQ,QAAM;AAAA,IACjB;AAAA,EAED;AAED,WAAS,UAAU,KAAI;AACtB,SAAK,QAAM;AACX,YAAQ,QAAM;AACd,YAAQ,QAAM;AAAA,EACd;AAED,SAAO;AAAA,IACP;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACC;AAGF,CAAC;;"}